%%
\newif\ifDraft
\Drafttrue % comment this out for submission

\documentclass[sigconf,anonymous,review,balance=false]{acmart}
\usepackage{popets}

% Copyright
\setcopyright{popets}
\copyrightyear{YYYY}

% Issue info
\acmYear{YYYY}
\acmVolume{YYYY}
\acmNumber{X}
\acmDOI{XXXXXXX.XXXXXXX}
\acmISBN{}
\acmConference{Proceedings on Privacy Enhancing Technologies}
\settopmatter{printacmref=false,printccs=false,printfolios=true}

\input{../sty/packages.tex}  %<-------------- Add new packages here
\input{../sty/macros.tex}
\input{../sty/notation.tex}

%DIF UNDERLINE PREAMBLE %DIF PREAMBLE

\RequirePackage[normalem]{ulem} %DIF PREAMBLE

\RequirePackage{color}\definecolor{RED}{rgb}{1,0,0}\definecolor{BLUE}{rgb}{0,0,1} %DIF PREAMBLE

\providecommand{\DIFadd}[1]{{\protect\color{blue}\uwave{#1}}} %DIF PREAMBLE

\providecommand{\DIFdel}[1]{{\protect\color{red}\sout{#1}}}                      %DIF PREAMBLE

%DIF SAFE PREAMBLE %DIF PREAMBLE

\providecommand{\DIFaddbegin}{} %DIF PREAMBLE

\providecommand{\DIFaddend}{} %DIF PREAMBLE

\providecommand{\DIFdelbegin}{} %DIF PREAMBLE

\providecommand{\DIFdelend}{} %DIF PREAMBLE

%DIF FLOATSAFE PREAMBLE %DIF PREAMBLE

\providecommand{\DIFaddFL}[1]{\DIFadd{#1}} %DIF PREAMBLE

\providecommand{\DIFdelFL}[1]{\DIFdel{#1}} %DIF PREAMBLE

\providecommand{\DIFaddbeginFL}{} %DIF PREAMBLE

\providecommand{\DIFaddendFL}{} %DIF PREAMBLE

\providecommand{\DIFdelbeginFL}{} %DIF PREAMBLE

\providecommand{\DIFdelendFL}{} %DIF PREAMBLE

%DIF END PREAMBLE EXTENSION ADDED BY LATEXDIFF
\begin{document}
	
	%%
	%% The "title" command has an optional parameter,
	%% allowing the author to define a "short title" to be used in page headers.
	\title{Secure Vickrey Auctions with Rational Parties}
	
	%%%%%%%%%%%%%%%% Authors' Info %%%%%%%%%%%%%%%%%
	%%
	%% The "author" command and its associated commands are used to define
	%% the authors and their affiliations.
	
	%\author{Ben Trovato}
	%\orcid{1234-5678-9012}
	%\affiliation{%
		%  \institution{Institute for Clarity in Documentation}
		%  \city{Dublin}
		%  \state{Ohio}
		%  \country{USA}}
	%\email{trovato@corporation.com}
	
	%\author{Lars Th{\o}rv{\"a}ld}
	%\affiliation{%
		%  \institution{The Th{\o}rv{\"a}ld Group}
		%  \city{Hekla}
		%  \country{Iceland}}
	%\email{larst@affiliation.org}
	
	%\author{Valerie B\'eranger}
	%\affiliation{%
		%  \institution{Inria Paris-Rocquencourt}
		%  \city{Rocquencourt}
		%  \country{France}
		%}
	%\email{valerie@affiliation.org}
	
	%\author{Aparna Patel}
	%\affiliation{%
		% \institution{Rajiv Gandhi University}
		% \city{Doimukh}
		% \state{Arunachal Pradesh}
		% \country{India}}
	%\email{aparnap@rgu.ac.in}
	
	%\author{Huifen Chan}
	%\affiliation{%
		%  \institution{Tsinghua University}
		%  \city{Haidian Qu}
		%  \state{Beijing Shi}
		%  \country{China}}
	%\email{huifenchen@tsinghua.edu.cn}
	
	%\author{T. Charles Palmer}
	%\affiliation{%
		%  \institution{Palmer Research Laboratories}
		%  \city{San Antonio}
		%  \state{Texas}
		%  \country{USA}}
	%\email{tcpalmer@prl.com}
	
	%\author{John Arthur Smith}
	%\affiliation{%
		%  \institution{The Th{\o}rv{\"a}ld Group}
		%  \city{Hekla}
		%  \country{Iceland}}
	%\email{jsmith@affiliation.org}
	
	%\author{Julius P. L. Kumquat}
	%\affiliation{%
		%  \institution{The Kumquat Consortium}
		%  \city{New York}
		%  \country{USA}}
	%\email{jplkumquat@consortium.net}
	
	%%
	%% By default, the full list of authors will be used in the page
	%% headers. Often, this list is too long, and will overlap
	%% other information printed in the page headers. This command allows
	%% the author to define a more concise list
	%% of authors' names for this purpose.
	
	%\renewcommand{\shortauthors}{Trovato et al.}
	
	%%
	%% The abstract is a short summary of the work to be presented in the
	%% article.

	\begin{abstract}
		In this work, we construct a second price (Vickrey) auction protocol (SPA), which does not require any auctioneers and ensures total privacy in the presence of rational parties participating in auction. In particular, the confidentiality of the highest bid value and the identity of the second highest bidder are protected. We model the bidders participating in the second price auction as rational, computationally bounded and privacy sensitive parties. These are self-interested agents who care about winning the auction more than learning about the private bid values of other parties. A rational party does not deviate from the protocol arbitrarily, but does so only for its own individual `advantage' -- without any consideration for others. Such an advantage is modeled using suitable utility functions. 
		
		We show that for rational PPT parties participating in our second-price auctions protocol, there exists a privacy-preserving dominant strategy equilibrium in which every party prefers to follow the protocol than to deviate.
		
		Our protocol is implemented using open source cryptographic constructs. Running our SPA protocol on commodity hardware with $15$ bidders,  with bids of length $10$ bits,  completes in $1.26$sec and has total communication of $0.77$MB whereas for the same setting, Atlas (semi-honest) protocol takes $2.11$ sec with $6.09$MB of communication.
	\end{abstract}

 %%
%% The code below is generated by the tool at http://dl.acm.org/ccs.cfm.
%% Please copy and paste the code instead of the example below.
%%
%\begin{CCSXML}
%<ccs2012>
% <concept>
%  <concept_id>00000000.0000000.0000000</concept_id>
%  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
%  <concept_significance>500</concept_significance>
% </concept>
% <concept>
%  <concept_id>00000000.00000000.00000000</concept_id>
%  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
%  <concept_significance>300</concept_significance>
 %</concept>
% <concept>
%  <concept_id>00000000.00000000.00000000</concept_id>
%  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
%  <concept_significance>100</concept_significance>
% </concept>
% <concept>
%  <concept_id>00000000.00000000.00000000</concept_id>
%  <concept_desc>Do Not Use This Code, Generate the Correct Terms for Your Paper</concept_desc>
%  <concept_significance>100</concept_significance>
% </concept>
%</ccs2012>
%\end{CCSXML}

%\ccsdesc[500]{Do Not Use This Code~Generate the Correct Terms for Your Paper}
%\ccsdesc[300]{Do Not Use This Code~Generate the Correct Terms for Your Paper}
%\ccsdesc{Do Not Use This Code~Generate the Correct Terms for Your Paper}
%\ccsdesc[100]{Do Not Use This Code~Generate the Correct Terms for Your Paper}
%%
%% Keywords. The author(s) should pick words that accurately describe
%% the work being presented. Separate the keywords with commas.
	\keywords{Auctions, rational parties, Vickrey auctions, equilibrium}
	
	
	\maketitle
	
	%\input{intro.tex}
	\section{Introduction} Auctions are mechanisms where buyers compete to purchase goods by bidding. They are characterized by their ability to efficiently allocate goods to those buyers who value them the most, while fetching profit to the sellers. Digital auctions are a billion-dollar industry with companies like Google, Meta etc. running as many auctions daily in order to auction out their ad space. There is hardly any sector that does not use them -- auctions are used for fundraising, spectrum allocations by governments and trading commodities in financial markets. Typically, it is the highest bidder who wins the auction. Depending on the price paid by the winner of the auction, we can have either \emph{first price auctions} where the winner pays the highest bid value or \emph{second price auctions} (Vickrey auctions) where the winner pays the second highest bid value. \\
	
	Second price auctions (SPA) are known to be strategy-proof; that is, while participating in second price auctions, the bidders are incentivized to bid their true valuation~\cite{vk09}, without considering the bid values of other parties. This is in contrast to  first price auctions, where bidders may choose their bid values strategically. 
	
	Second price auctions satisfy the requirements of both auctioneer and bidders. The auctioneer is able to elicit true valuations from bidders and hence sells the item to the bidder who values the item most. The winning bidder gets to purchase the auctioned item at a discount (compared to its valuation). Often, an important goal for auctions is to ensure the privacy of bid values: for this, there are sealed bid auctions. Privacy is especially critical for second price auctions, where bidders use their true valuation as their bids. The bidders may not want to divulge any information about their bid values. In particular, the highest bidder too would not want to divulge its own bid value. Similarly, while the highest bidder pays the value of the second highest bidder, the latter would wish to keep its own identity secret. A secure second price auction protocol should only output the winner's identity and the second highest bid value: the highest bid value and the identity of the second highest bidder should not be revealed by the protocol, in addition to protecting the confidentiality of losing bids. 
	
	When auctions are executed by auctioneers who are trusted, it is rather trivial to ensure such privacy requirements. But such trust is difficult to realize in practice. Moreover, even when privacy is ensured, second price auctions are vulnerable to manipulation by a corrupt auctioneer. An auctioneer can enhance its utility by declaring a higher value for the second highest bid. Hence, designing a protocol that can function without needing an auctioneer is desirable. 
	
	All existing protocols for second price auctions either need a trusted auctioneer or use generic Multi Party Computation (MPC) protocols; therefore, they assume some parties to be completely honest. \emph{In this work, we build a protocol secure in the rational setting for second price auctions that guarantees privacy and does not require any trusted auctioneer.} 
	
	
	\paragraph{Rational model.} In traditional cryptography, every party is either honest or malicious. However, there are many scenarios where parties are simply rational agents who have a clearly specified end goal they are trying to achieve. In the case of auctions, for example, it is fair to assume that the primary goal of parties is to win the auction. 
	At a high level, a rational party deviates from the protocol only if it has something to `gain'.  This gain is defined by a utility function associated with the party.  Assuming all parties are rational, any party participating in an auction protocol would do so to win it. If they cannot win the auction, a secondary goal of a party may be to learn about the bids of other parties involved in a sealed bid auction.  In this work, we construct a privacy preserving protocol for sealed bid second price auction in a rational model.
	
	
	
	\paragraph{Our contribution.}
	This work presents a concretely efficient protocol for \emph{Second Price Auction} with guaranteed privacy. Our protocol achieves \emph{Computational Weakly Dominant Strategy Equilibrium} for rational PPT parties without the need for any trusted auctioneer to maintain the privacy of bid values. In our security model, the bidders are modeled as privacy-sensitive, self-interested agents using appropriate utility functions to capture their motivation to maximize their individual utilities. Our protocol ensures that a) playing honestly is indeed the weakly dominant strategy equilibrium for parties and b) when players play honestly, the protocol leaks nothing except for the output -- the highest bidder identity and value of the second highest bid. \\
	We would like to emphasize that the rational security model is incomparable with standard models like semi-honest and malicious models in MPC. For one, rational model does not consider collusion whereas in both the semi-honest and malicious models, there is a single adversary controlling corrupt parties -- up to certain threshold. Such a threshold assumption implies that there should exist at least some honest parties in the protocol. In contrast, in the rational model we consider, there are \textit{no honest parties}; all parties are rational who might form strategic coalition for better gains.\\
	We have implemented our protocol in C++ with 2.4k lines of code. We build upon OpenSSL and Boost open-source libraries. Running our rational secure protocol on a commodity hardware (with Intel core i7 processor, 2.9 GH), with $15$ bidders, $10$-bit length bids resulted in $0.77$MB communication and took $1.26$s. We show that our protocol is concretely more efficient than secure second price auction implementations realized using generic MPC protocols.
	
	\paragraph{Outline.} The rest of the paper is organized as follows. Related works is presented in Section~\ref{sec-rel-work} where we provide a survey of prior works related to rational security and auctions. Section~\ref{techoverview} presents an overview of our work, specifically highlighting the challenges and design decisions for SPA protocol. Preliminaries are described in Section~\ref{sec-prelim}. Section~\ref{sec-rational-security} describes the rational security model used in our work. Section~\ref{sec-proto-spec-spa} provides a detailed description of the protocol divided into multiple phases. We analyze the strategy space available to rational parties along with security proofs in Section~\ref{sec-rational-strtg}. For each strategy, we argue why it is rational for parties to stay honest. Lastly, we summarize the experimental results in Section~\ref{sec-expt} and conclude.
	
	
	%\input{related-work}
	\subsection{Related work}\label{sec-rel-work} 
	
	\paragraph{Game theoretic tools for cryptography.} The intersection of game theory and cryptography has attracted interest from the cryptographic research community for the past two decades. The work of Dodis, Halevi and Rabin~\cite{C:DodHalRab00} initiated a line of work capturing notions of incentives in cryptographic definitions. The work of Halpern and Teague~\cite{STOC:HalTea04} considered secret sharing and secure computation in the rational setting. They define a solution concept that is a variant of Nash equilibrium. Subsequent works define further variants of equilibrium, like computational versions and for modelling collusion~\cite{PODC:ADGH06,SCN:GorKat06,PODC:Halpern08,TCC:KolNao08,ITCS:HalPas10}. A noteworthy contribution in rational cryptography is the Rational Protocol Design (RPD) framework introduced by Garay, Katz, Maurer, Tackmann and Zikas~\cite{FOCS:GKMTZ13} and employed subsequently in~\cite{PODC:GKTZ15,EC:BGMTZ18}.  RPD models the  protocol design as a two party game between a protocol designer and an external attacker, where the attacker's goal is to break security properties, and the goal of the protocol designer is to prevent the attacker from succeeding. Bi{\c{c}}er, Yildiz and K{\"u}p{\c{c}}{\"u}~\cite{byk21} make use of \emph{Weakly dominant strategy} for coalitions in their work  to develop the notion of \emph{m-stability} which offers threshold security against a coalition of size $m$. 
	
	\paragraph{Auctions.}
	The work of Miltersen, Nielsen and Triandopoulos \cite{C:MilNieTri09} defined a rational security framework for first price auctions wherein the bidders care more about the monetary payoffs  than learning about bids of other parties. Important contributions of their work are a novel notion of \emph{information utility} and \textit{Privacy enhanced computational Nash Equilibrium} for modeling rational security. They use generic MPC protocols to run the first price  auction and show that their protocol achieves this equilibrium. However, Nash equilibrium ensures honesty for a rational party only when all other parties are also honest. Instead, we make use of stronger notion of dominant strategy equilibrium wherein honest strategy is the best response irrespective of others' strategic choices. Moreover, our solution concept also guarantees privacy by exhibiting a simulator.\\
	SEAL~\cite{seal19} was a work by Bag, Hao, Shahandashti and Ray, who propose auction protocols without needing auctioneers. They make use of \emph{Anonymous Veto Protocol} (AVP)~\cite{avp06}. FAST~\cite{fast21} is a similar protocol by David, Gentile and Pourpouneh, which also uses AVP. However, both these works have a non-trivial leakage. Their first price auction protocol leaks first few bits of second highest bid value and their second price auction protocol leaks first few bits of highest bid value. Ganesh, Kanukurthi and Shankar have introduced a first price auction protocol without requiring auctioneers but ensuring total privacy in a rational setting in~\cite{gks22}.   
	
	\paragraph{Second price auctions.}
	Brandt introduced the protocol for second price auctions in \cite{brandt01}. In this protocol, the auctioneer is privy to bid values from all parties. This is avoided in the work of Kurosawa and Ogata~\cite{ko02}, who use bit-slice approach with multiple auctioneers, the majority of whom are honest, to determine the highest bid, bit by bit. Work by Nojoumian and Stinson~\cite{ns14}, uses a setting with $m$ bidders and $n$ auctioneers in addition to a trusted party. \\
	Naor, Pinkas and Sumner~\cite{nps99} require the role of an auctioneer for running the auction, apart from the auction-issuer who sets up the auction. These two entities are expected not to collude. Their protocol uses garbled circuits prepared by the auction-issuer. In a similar setting, Lipmaa, Asokan and Neimi~\cite{lan02} introduce a second price auction protocol which requires the roles of auctioneer and seller who do not collude. They use a pre-specified set of bid values to run auction. \\
	In the work of Boaz and Herzberg~\cite{ch13}, the auctioneer is not trusted. Instead, a trusted supervisor ensures that the auctioneer does not deviate by running random checks on the computation. Rational setting is used to argue the security. In~\cite{micali14}, Micali and Rabin discuss the prevention of collusion among bidders participating in Vickrey auctions. They incentivize the second highest bidder to stay truthful and thus prevent coullusion among bidders.\\
	Omote \etal~\cite{FC:OmoMiy02} introduced a protocol using two non-colluding auctioneers -- $AM_1$ and $AM_2$. $AM_1$ is used during the setup stage and $AM_2$ for the computation stage. Similar to Lipmaa \etal~\cite{lan02}, bidders can use only pre-specified points as bid values. Another similar work is by Hso and Miyaji~\cite{hm21}, who use smart contracts to run generalized Vickrey auctions on a pre-specified number of bid points. \\
	
	All works mentioned above require the presence of one or more auctioneers and/or some additional entities for running the auction. In some cases, bidders are allowed to choose the bid values only from a pre-specified set of bid values. Our work does not require any auctioneer and has flexibility for bidders to choose their bids.
	
	
	%\input{tech-overview.tex}
	\subsection{Technical overview}\label{techoverview}
	\paragraph{Threat model.} 
	In our rational security model, every party may deviate from the protocol to meet their most desired goal of winning the auction. Other considerations, such as learning information about other parties, do exist but are secondary. Parties can either act in their individual capacity or form strategic coalitions for enhancing their gains. The utility function captures these considerations. %At CCS 2022, Ganesh, Kanukurthi and Shankar~\cite{gks22} built a protocol for first price auctions secure in the rational security model. The authors show that their protocol achieves \emph{privacy enhanced weakly dominant strategy equilibrium}. At a high level, this involves two steps: a) one needs to show that following the protocol is indeed a (weakly) dominant strategy equilibrium for the parties and b) use the simulation paradigm to argue privacy when parties are honest. We show that our second price auction protocol satisfies this equilibrium.
	
	\paragraph{Second price auctions: challenges and design overview.}
	It is tempting to design a SPA protocol as an extension of an existing first price auction (FPA) protocol. However, the computed output and the privacy considerations are quite different for the two protocols. Recall that, in a FPA protocol, the computed output is the highest bid. Thus, it suffices to design a secure computation protocol that identifies the maximum value among the individual bids of parties participating in the protocol. However for SPA, we need to identify the highest bidder without revealing the highest bid and compute second highest bid without revealing the identity of second highest bidder. Attempts to extend the FPA protocol to run SPA have typically resulted in leakage. For instance, SEAL~\cite{seal19}, FAST~\cite{fast21} and ~\cite{gks22} have developed protocols for implementing secure auctions. While SEAL and FAST provide a SPA protocol explicitly, \cite{gks22} can be extended to run SPA\footnote{Run the FPA till end to identify the winner; rerun auction without winner's participation to identify second highest bid.}. However, in each of these three cases the highest bid value gets leaked while running the second price auctions. In our work, we overcome this problem by performing \emph{oblivious winner discovery} and thus protecting the confidentiality of highest bid value and identity of second highest bidder.\\
 
 Our protocol is divided into two sub-protocols first of which is used for \emph{oblivious winner discovery} (OWD) and second one for computing the second highest bid (SHB). The OWD functionality uses inputs from the bidders to identify the winner. 
    
 Our choice for OWD is to design a bit-by-bit protocol in which highest bidder learns that it has the highest bid, without any other bidder learning about it. Subsequently, for computing SHB, the highest bidder would need to act in such a way that computed output is the second highest bid value -- with the additional requirement that second highest bidder's identity is not revealed.
	
	
	For this we can consider a sub-protocol that computes the MAX function bit-by-bit using a bulletin board as described next. The parties start by contributing bits from their bid values, MSB onward. In the first round, they learn the OR of the first bit of all parties. If a party has contributed a $0$, but the output of the first round was $1$, it does not have the maximum bid and hence drops out of the ``race". However such a party continues to participate\footnote{The security-deposit collected up front in the protocol ensures such participation} in the protocol and contributes a $0$ bit for all subsequent rounds of computation. This process continues, with parties dropping out of the race once they realize they no longer have the highest bid (MAX) value. Thus, the computed output is the MAX of all inputs, as required for FPA computing (but does not suffice for SPA). This sub-protocol is called the Anonymous Bidding Protocol (ABP) (see Appendix~\ref{proto-abp}). In our work we use ABP which has found applications in prior works such as SEAL~\cite{seal19}, FAST~\cite{fast21} and ~\cite{gks22}.   
	
	\begin{figure}[h]
		\includegraphics[scale=0.28]{protocol-exec-flow.png}
		\caption{Protocol flow for an arbitrary party}
		\label{fig-proto-desc}
	\end{figure}
	\begin{figure}[h]
	\includegraphics[scale=0.28]{post-winner-desc.png}
	\caption{Protocol flow post winner-discovery}
	\label{fig-proto-post-wd}
\end{figure}
	For the case of SPA, our goal is to compute the second highest bid value and not the MAX value -- i.e., we cannot use ABP as is. To enable computation of second highest bid value, the highest bidder too needs to drop out of the race during the ABP run. However, this poses few challenges: \emph{
	a) we need to ensure the privacy of the highest bid value, i.e., the highest bidder's dropping off must be concealed from all other parties (oblivious winner discovery). 
	b) once the highest bidder drops off by contributing $0$ bits, the second highest bidder might conclude incorrectly that it is the highest bidder. In other words, the highest bidder should be able to trick the second highest bidder, by design, into believing that it is still in the race!
	c) lastly, second highest bidder's identity should not get revealed.}
	
	We overcome the first challenge by leveraging one key property of the ABP protocol: A party that contributes a $1$ bit can compute \textsc{OR} of inputs of other parties in ABP using the encoded bits of rest of the parties. This allows us to build a ``winner discovery mechanism" where the highest bidder can (privately) learn that it has the highest bid. Moreover, the protocol design is such that, the winner behaves in such a way as to ensure that all other parties remain oblivious to winner discovery. Overcoming the second challenge requires a very intricate use of Oblivious Transfer (OT), Commitments and NIZKs. The last challenge is overcome by ensuring that it is rational for only the highest bidder to claim the auction. Any deviant claimants are detected by winner resolution protocol.\\
	
	Here is a high-level overview of our protocol. We begin by making the following observations :
	\begin{enumerate}
		\item The protocol runs for $l$ rounds, where $l$ is the number of bits used in binary representation of bids.
		\item There exists a unique $\bar j\in[l]$ such that bits of the second highest bid are the same as bits of the highest bid for the first $\bar j-1$ rounds.
		\item In $\bar {j}$th round, highest bid has $1$, whereas second highest bid has $0$.
		\item In all the rounds after $\bar j$th round, the highest bid identified in $\bar j$th round should be ignored for further computation.
	\end{enumerate}
	
	The round $\bar j$ is the winner discovery round. For privacy of highest bid, we need to ensure that this $\bar j$th round is identified only by the winner and no one else. Further, the highest bidder should get access to the bits of the second highest bid after knowing it has won. Note that this does not pose any privacy threat, as the second highest bid is the protocol output. To achieve these objectives, every round needs to be divided further into two steps. The first one is for every party to know if it is the winner and if so, get access to the bit of second highest bid. The second step is for the highest bidder to match the second highest bid. We achieve this while ensuring every party, other than the highest bidder, is oblivious to whether someone has already won the auction. Specifically, the second highest bidder should not know that it has lost the auction during the protocol. We tackle these challenges by pairwise OT communication among parties. At the end of protocol, we seek proof that each party has acted honestly. 
	
	Now we present the design of the protocol, which is divided into 3 main phases:
	
	\begin{enumerate}
		\item \textsc{Set-up Phase}: Each party $P_i$ has private bid value $b_i$. $P_i$ registers for auction by paying a deposit $D$ and receives the public parameters $\mathsf{pp}$. Party $P_i$ commits to bits of its bid value. Commitments are used to generate NIZK proofs to verify the correctness of $P_i$'s computations in the event that $P_i$ does not win the auction.
  \begin{comment}
      
  
		\begin{center}
			\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1,scale=0.7, every node/.style={scale=1.2}]
				
				\draw   (48,19.18) .. controls (48,8.59) and (56.59,0) .. (67.18,0) -- (277.32,0) .. controls (287.91,0) and (296.5,8.59) .. (296.5,19.18) -- (296.5,90.42) .. controls (296.5,101.01) and (287.91,109.6) .. (277.32,109.6) -- (67.18,109.6) .. controls (56.59,109.6) and (48,101.01) .. (48,90.42) -- cycle ;
				
				\draw    (47.2,163.6) -- (78.06,119.24) ;
				\draw [shift={(79.2,117.6)}, rotate = 124.82] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
				
				\draw    (143.2,163.6) -- (153.71,121.54) ;
				\draw [shift={(154.2,119.6)}, rotate = 104.04] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
				
				\draw    (289.2,159.6) -- (266.16,117.36) ;
				\draw [shift={(265.2,115.6)}, rotate = 61.39] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
				
				\draw   (24.66,225.31) .. controls (23.55,222.97) and (22.94,220.4) .. (22.95,217.71) .. controls (23,206.84) and (33.14,198.06) .. (45.62,198.12) .. controls (58.09,198.17) and (68.16,207.03) .. (68.12,217.91) .. controls (68.11,220.6) and (67.48,223.16) .. (66.35,225.49) -- cycle ;
				
				\draw   (33.28,184.86) .. controls (33.28,177.54) and (39.11,171.6) .. (46.31,171.6) .. controls (53.51,171.6) and (59.34,177.54) .. (59.34,184.86) .. controls (59.34,192.18) and (53.51,198.12) .. (46.31,198.12) .. controls (39.11,198.12) and (33.28,192.18) .. (33.28,184.86) -- cycle ;
				
				\draw   (122.66,226.31) .. controls (121.55,223.97) and (120.94,221.4) .. (120.95,218.71) .. controls (121,207.84) and (131.14,199.06) .. (143.62,199.12) .. controls (156.09,199.17) and (166.16,208.03) .. (166.12,218.91) .. controls (166.11,221.6) and (165.48,224.16) .. (164.35,226.49) -- cycle ;
				%Shape: Ellipse [id:dp9744217252097183] 
				\draw   (131.28,185.86) .. controls (131.28,178.54) and (137.11,172.6) .. (144.31,172.6) .. controls (151.51,172.6) and (157.34,178.54) .. (157.34,185.86) .. controls (157.34,193.18) and (151.51,199.12) .. (144.31,199.12) .. controls (137.11,199.12) and (131.28,193.18) .. (131.28,185.86) -- cycle ;
				%Shape: Chord [id:dp2160282391881323] 
				\draw   (274.66,221.31) .. controls (273.55,218.97) and (272.94,216.4) .. (272.95,213.71) .. controls (273,202.84) and (283.14,194.06) .. (295.62,194.12) .. controls (308.09,194.17) and (318.16,203.03) .. (318.12,213.91) .. controls (318.11,216.6) and (317.48,219.16) .. (316.35,221.49) -- cycle ;
				%Shape: Ellipse [id:dp9679921222195755] 
				\draw   (283.28,180.86) .. controls (283.28,173.54) and (289.11,167.6) .. (296.31,167.6) .. controls (303.51,167.6) and (309.34,173.54) .. (309.34,180.86) .. controls (309.34,188.18) and (303.51,194.12) .. (296.31,194.12) .. controls (289.11,194.12) and (283.28,188.18) .. (283.28,180.86) -- cycle ;
				%Straight Lines [id:da5499018212725999] 
				\draw  [dash pattern={on 1.5pt off 7.5pt}]  (192.2,203.6) -- (228.2,203.6) ;
				
				% Text Node
				\draw (79,31) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75] [align=left] {$\mathsf{pp}$=\{$q, \displaystyle \grp$, $\displaystyle g,\ h,\ $, $\displaystyle l, \tau$\}\\$\displaystyle  \begin{array}{{>{\displaystyle}l}}
						c_{ij} =g^{b_{ij}} h^{a_{ij}{}} ,\ \forall i\in [n], \forall j \in [l]\\
						X_{ij} =g^{x_{ij}} ,\ \forall i\in [ n] ,\ \forall j\in [ l]
					\end{array}$};
				% Text Node
				\draw (3,229) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize,xscale=0.75,yscale=0.75] [align=left] {$\displaystyle  \begin{array}{{>{\displaystyle}l}}
						x_{1j} ,\ r_{1j} ,\ a_{1j} ,\ \\
						\ \ \ \ \mathsf{pp},\ b_{1j}
					\end{array}$,};
				% Text Node
				\draw (256,224) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize,xscale=0.75,yscale=0.75] [align=left] {$\displaystyle  \begin{array}{{>{\displaystyle}l}}
						x_{nj} ,\ r_{nj} ,\ a_{nj} ,\ \\
						\ \ \ \ \mathsf{pp},\ b_{nj}
					\end{array}$,};
				% Text Node
				\draw (105,229) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize,xscale=0.75,yscale=0.75] [align=left] {$\displaystyle  \begin{array}{{>{\displaystyle}l}}
						x_{2j} ,\ r_{2j} ,\ a_{2j} ,\ \\
						\ \ \ \ \mathsf{pp},\ b_{2j}
					\end{array}$,};
				% Text Node
				\draw (161,3.4) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75]  {$\underline{BB}$};
			\end{tikzpicture}
		\end{center}
  \end{comment}
		\item \textsc{Auction Phase}: The protocol proceeds in rounds. A typical round $j$ for an arbitrary party $P_i$ is depicted in Figure~\ref{fig-proto-desc}. In each round, parties run the SPA protocol as follows. 
		\begin{itemize}
			\item \textsc{Exchange of encoded bits}: The goal of this step is to enable parties to deduce if they have won the auction. Every pair of parties communicate privately with each other using OT. As a receiver of OT in round $j$, $P_k$ uses $d_{kj}$ as its choice bit where $d_{kj}$ is the bit being contributed for computation by $P_k$ in round $j$. %The choice bit of OT receiver is important to prevent the second highest bidder from knowing it has lost before the last round of ABP ends. 
			As a sender, $P_k$ uses encoding of $d_{kj}$ as $M^{(1)}$ and $0$-token as $M^{(0)}$ for OT. 
			%Therefore, whenever the second highest bidder contributes $0$, it has no information about the bid of the winner.
			
			\item \textsc{Winner discovery}: Each party checks if it is the only party contributing $1$ in that round. As the OT receiver, every party gets the inputs of other parties and deduces that it has won if \textsc{OR} of other parties' contributing bits is $0$. If so, it concludes that it has won the auction and transitions to \textit{winner} state.
   
			\item \textsc{Post winning actions}: (Refer to Figure~\ref{fig-proto-post-wd}.) Here, we introduce one important change for computing $d_{kj}$: after a party knows it has won the auction, it uses $d_{kj}=1$ in all subsequent OT rounds, both as choice bit and for generating $M^{(1)}$. This design choice helps the winner to obtain the contribution bit of the second highest bidder in the current round. This also prevents second highest bidder from assuming that it has the highest bid. As an OT receiver, the winner gets to know the \textsc{OR} of other parties, which is the same as the bit of the second highest bidder. %After a party has concluded that it is the winner, from the following round onward, it writes \textsc{OR} of the other parties to the BB. 
			
			\item  Any party that contributes $0$ has no information about the computed value in the current round. It is necessary to make the computed bit known to each party involved in the auction. Hence, every party writes the encoding of its contribution bit to the BB so that all parties involved in the protocol can compute the output of the current round. The winner (if already discovered) writes the same bit as that of second highest bidder.
   \begin{comment}
			\begin{center}
				%\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        
				
				%\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1,scale=0.8, every node/.style={scale=1.3}]
				
				
				\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        
				
				\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1,scale=0.7, every node/.style={scale=1.3}]
					%uncomment if require: \path (0,281); %set diagram left start at 0, and has height of 281
					
					%Flowchart: Alternative Process [id:dp046329102683471346] 
					\draw   (48,21.57) .. controls (48,12.2) and (55.6,4.6) .. (64.97,4.6) -- (279.52,4.6) .. controls (288.9,4.6) and (296.5,12.2) .. (296.5,21.57) -- (296.5,84.62) .. controls (296.5,94) and (288.9,101.6) .. (279.52,101.6) -- (64.97,101.6) .. controls (55.6,101.6) and (48,94) .. (48,84.62) -- cycle ;
					%Straight Lines [id:da643896309767152] 
					\draw    (49.2,151.6) -- (78.12,106.29) ;
					\draw [shift={(79.2,104.6)}, rotate = 122.55] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
					%Straight Lines [id:da04511702283590768] 
					\draw    (291.2,152.6) -- (266.22,110.32) ;
					\draw [shift={(265.2,108.6)}, rotate = 59.42] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
					%Shape: Chord [id:dp35655643242043] 
					\draw   (24.66,215.31) .. controls (23.55,212.97) and (22.94,210.4) .. (22.95,207.71) .. controls (23,196.84) and (33.14,188.06) .. (45.62,188.12) .. controls (58.09,188.17) and (68.16,197.03) .. (68.12,207.91) .. controls (68.11,210.6) and (67.48,213.16) .. (66.35,215.49) -- cycle ;
					%Shape: Ellipse [id:dp27531625949260374] 
					\draw   (33.28,174.86) .. controls (33.28,167.54) and (39.11,161.6) .. (46.31,161.6) .. controls (53.51,161.6) and (59.34,167.54) .. (59.34,174.86) .. controls (59.34,182.18) and (53.51,188.12) .. (46.31,188.12) .. controls (39.11,188.12) and (33.28,182.18) .. (33.28,174.86) -- cycle ;
					%Shape: Chord [id:dp2160282391881323] 
					\draw   (274.66,211.31) .. controls (273.55,208.97) and (272.94,206.4) .. (272.95,203.71) .. controls (273,192.84) and (283.14,184.06) .. (295.62,184.12) .. controls (308.09,184.17) and (318.16,193.03) .. (318.12,203.91) .. controls (318.11,206.6) and (317.48,209.16) .. (316.35,211.49) -- cycle ;
					%Shape: Ellipse [id:dp9679921222195755] 
					\draw   (283.28,170.86) .. controls (283.28,163.54) and (289.11,157.6) .. (296.31,157.6) .. controls (303.51,157.6) and (309.34,163.54) .. (309.34,170.86) .. controls (309.34,178.18) and (303.51,184.12) .. (296.31,184.12) .. controls (289.11,184.12) and (283.28,178.18) .. (283.28,170.86) -- cycle ;
					%Shape: Rectangle [id:dp5041460798645792] 
					\draw   (135,172) -- (205,172) -- (205,212) -- (135,212) -- cycle ;
					%Straight Lines [id:da056543615437074424] 
					\draw    (207.2,190.65) -- (248.2,191.6) ;
					\draw [shift={(205.2,190.6)}, rotate = 1.33] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-4.9) .. controls (6.95,-2.3) and (3.31,-0.67) .. (0,0) .. controls (3.31,0.67) and (6.95,2.3) .. (10.93,4.9)   ;
					%Straight Lines [id:da6877982954395949] 
					\draw    (92.2,198.6) -- (133.2,199.55) ;
					\draw [shift={(135.2,199.6)}, rotate = 181.33] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-4.9) .. controls (6.95,-2.3) and (3.31,-0.67) .. (0,0) .. controls (3.31,0.67) and (6.95,2.3) .. (10.93,4.9)   ;
					%Straight Lines [id:da8539916304433743] 
					\draw    (92.2,181.6) -- (133.2,182.55) ;
					\draw [shift={(135.2,182.6)}, rotate = 181.33] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (10.93,-4.9) .. controls (6.95,-2.3) and (3.31,-0.67) .. (0,0) .. controls (3.31,0.67) and (6.95,2.3) .. (10.93,4.9)   ;
					
					% Text Node
					\draw (157,12.4) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75]  {$\underline{BB}$};
					\draw (75,70) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75]  {$B_{kj}$};
					\draw (245,70) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75]  {$B_{ij}$};
					
					% Text Node
					\draw (158,184) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75] [align=left] {OT};
					% Text Node
					\draw (65,157.4) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize,xscale=0.75,yscale=0.75]  {$M_{kj}^{( 0)} =g^{\omega _{kj}}$};
					% Text Node
					\draw (70,203.4) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize,xscale=0.75,yscale=0.75]  {$M_{kj}^{( 1)} =B_{kj}$};
					% Text Node
					\draw (217,172.4) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize,xscale=0.75,yscale=0.75]  {$cb_{ij},k =d_{ij}$};
					% Text Node
					\draw (285,218.4) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75]  {$P_{i}$};
					% Text Node
					\draw (36.6,224.2) node [anchor=north west][inner sep=0.75pt]  [xscale=0.75,yscale=0.75]  {$P_{k}$};
				\end{tikzpicture}
			\end{center}
   \end{comment}
		\end{itemize}
				
		\item \textsc{Verification phase}:
		\begin{itemize}
			\item  The winner comes forward to claim the auction by producing the private keys used for encoding the bit codes.
			
			\item Each losing party provides NIZK proof of correct computation for each round, where computed output is $1$. 
			Each losing party also produces the $0$-tokens for the rounds which have computed output to be $0$. This is to ensure that the parties have used the correct OT choice bit. \\
			If no party claims the auction, all parties are asked to provide these proofs. 
			\item In case there are multiple claimants for the auction -- which can happen if there are deviating parties, the protocol has a winner resolution mechanism. In this case, each claimant is asked to open all OT message randomness, which exposes the cheating party.
			\item Whenever a party's deviation is detected, the protocol terminates and that party forgoes their deposit, which gets distributed among honest parties.
		\end{itemize}
	\end{enumerate}
	
	\paragraph{Security.} 
	In order to argue security, we note that a rational party sees value in a) increasing its monetary utility by winning the auction and b) learning information about other players' inputs. To capture these, we use monetary and information utilities (similar to earlier works in~\cite{C:MilNieTri09,gks22}). We also use the notion of \emph{Privacy Enhanced Computational Dominant Strategy Equilibrium} introduced in ~\cite{gks22} for analyzing the privacy concerns of rational parties. This equilibrium states that as long as parties value monetary utility much more than information utility, they have no incentive to deviate from the protocol. Then, for parties that do not deviate from the protocol, we argue privacy using the simulation paradigm.

	%\input{prelim.tex}
	\begin{comment}
		
	\end{comment}
	
	\section{Preliminaries}\label{sec-prelim}
	\paragraph{Notation.}
	We denote the security parameter by $\lambda$. Let $\grp$ be the description of the group of prime order $q$, and with generators $g,h$.
	A function $\mathsf{negl}$ is said to be negligible if $\negl(n) < 1/p(n)$ for all positive polynomial functions $p(\cdot)$ and for all $n > n_0$ for some $n_0 \in \mathbb{N}$. 
	We denote \emph{Probabilistic Polynomial Time} by PPT. We also use $\approx_c$ to denote computational indistinguishability between two probability distributions.
	
	
	\subsection{Building blocks} Here we describe some key building blocks that are used in our protocol.
	
	\begin{definition}[Commitment scheme]
		Let $\sfm, \sfc, \sfr$ denote the message space, commitment space and randomness space respectively.\\
		A commitment scheme consists of a tuple ($\mathsf{Setup}, \com,\mathsf{Open}$) of PPT algorithms where:
		\begin{itemize}
			\item $\mathsf{Setup}(1^\lambda) \rightarrow \mathsf{pp}$ generates public parameters $\mathsf{pp}$.
			\item $\com(m,r) \rightarrow c$ takes as input $\mathsf{pp}$ (implicitly), a message $m \in \sfm$, randomness $r \in \sfr$ and outputs a commitment $c \in \sfc$. 
			\item $\mathsf{Open}(c, m, r) \rightarrow B \in \{0,1\}$ checks if the commitment $c$ opens to the message $m$, given randomness $r$. It outputs $1$ if the opening is acceptable and $0$ if the opening is rejected.
		\end{itemize}
	\end{definition}	
	
	
	The security of a commitment scheme guarantees two properties: \emph{hiding} and \emph{binding}. Informally, the hiding property guarantees that for any two messages $m_0$ and $m_1$, no PPT algorithm can distinguish between commitments to $m_0$ and $m_1$. The binding property guarantees that no PPT algorithm can open a commitment to two different messages. 
\begin{comment}
    We use the \emph{Pedersen Commitment Scheme} that is computationally binding and perfectly hiding. 
	\begin{definition} [Pedersen Commitment Scheme~\cite{C:Pedersen91}] \label{def-pedersen-commit}
		The Pedersen Commitment Scheme $\com$ instantiates the Commitment Scheme defined above as: 
		\begin{itemize}
			\item $(\grp, q, g, h) \leftarrow \mathsf{Setup}(1^\lambda)$. The $\mathsf{Setup}$ outputs the public parameters used in the commitment scheme.
			\item $c = \com(m, r) = g^m h^{r}$ where $m \in \zq$, $r \smpl \zq$ is chosen uniformly at random and $c \in \grp$.
			\item $B = \mathsf{Open}(c, m,r), B \in \{0,1\}$ verifies if $c$ is indeed the right commitment for message $m$ with opening randomness $r$. 
		\end{itemize}
	\end{definition} 
\end{comment} 	

	\paragraph{Oblivious transfer.} \label{proto-ot}
	Oblivious Transfer (OT) is a two-party  protocol with sender $S$ having two secret messages and receiver $R$ with a single choice bit. The goal of the protocol is for $R$ to learn the message of its choice without learning about the other message from the sender. In addition, OT protocol demands that $S$ does not learn about the choice exercised by $R$. We make use of OT for securely sharing messages between parties. Let $\sfm, \sfr$ be the message space and randomness space, respectively. An OT protocol proceeds as follows for two PPT parties, $R$ and $S$:
	\begin{itemize}
		\item $\mathsf{OT.R}_1(\alpha,\beta) \rightarrow (\otr^1, state)$ is invoked by $R$ with inputs: choice bit $\alpha \in \{0,1\}$, randomness $\beta \in \sfr$. $\otr^1$ is the first message sent by $R$ to $S$. $state$ is the internal state of $R$. 
		\item $\mathsf{OT.S}(\otr^1,M^{(0)},M^{(1)},\gamma) \rightarrow \ots_{S,R}$ takes $\otr^1$, messages $M^{(0)},M^{(1)} \in \mathsf{M}$, randomness $\gamma \in \sfr$ and outputs message $\ots_{S,R}$ to be sent by $S$ to $R$.
		\item $\mathsf{OT.R}_2(\ots_{S,R}, state) \rightarrow M^{(\alpha)}$ Invoked by $R$ with $\ots_{S,R}$ from $S$ and internal state to retrieve the message $M^{(\alpha)}$. 
	\end{itemize}
	The security of OT protocol ensures that the receiver does not learn about $M^{(1-\alpha)}$ and the sender does not learn about $\alpha$. 
	
	
	\paragraph{Bulletin board.}
	The \emph{Bulletin Board} (BB) is an abstraction for an authenticated broadcast channel with memory. We assume the  existence of such a broadcast channel for our protocol. We do acknowledge that implementation of such broadcast channels can have different threat models than ours. However, in this work we do not concern ourselves with the problem of handling broadcast in a rational setting, which is of independent interest and can be considered for future works. In our protocol, parties can write messages on to the BB for public consumption. The BB is expected to satisfy the following properties:
	(i) Every message  written on the BB is associated with a unique party and is readable by all other parties.
	(ii) The messages written on BB are immutable. 
	
	A BB can be realized through a public chat-room, shared web-page, or even a private blockchain. Our protocol does not rely upon any specific realization of BB.
	
	\subsection{Equilibrium notions}
	We now describe some game theoretic notations and definitions used in our work. We assume that there are $n$ parties $(P_1,\ldots,P_n)$ participating in a game. 
	
	\begin{definition}[Normal Form Game~\cite{TCC:Katz08b}] 
		A normal form game is a tuple $\left\{\{\Gamma_i\}_{i=1}^n, \{U_i\}_{i=1}^n \right\}$ where for each party $P_i$, a space of possible actions $\Gamma_i$ along with a utility function $U_i$ are specified. 
	\end{definition}
	
	Each party $P_i$ can be associated with certain strategy $\pi_i \in \strspc$ where $\strspc$ is a strategy space available for the parties to choose their strategies from, while playing the game. $\pi_i$ is essentially an algorithm that takes as input the private inputs of $P_i$, the current state of the game and outputs the action $s_i \in \Gamma_i$ to be taken by $P_i$ where $\Gamma_i$ is the space of actions available for party $P_i$ during the game. We denote the outcome of the game using the strategy profile of parties $(\pi_i,\pi_{-i})$ where $\pi_{-i} = (\pi_1, \ldots, \pi_{i-1}, \pi_{i+1}, \ldots, \pi_n)$. We also assign utility functions $U_i(\pi_i,\pi_{-i})$ to each party $P_i$. These functions represent the perceived utility of different outcomes of the game for the party. We say that a party $P_i$ \emph{prefers} a certain outcome $(\pi_i, \pi_{-i})$ over another outcome $(\pi_i', \pi_{-i})$ if and only if $U_i(\pi_i', \pi_{-i}) < U_i(\pi_i, \pi_{-i})$.
	\begin{definition} [Dominant Strategy~\cite{TCC:Katz08b}]
		Given a normal form game: $\left \{\{\Gamma_i\}_{i=1}^n, \{U_i\}_{i=1}^n\right \}$
		we say, $\pi_i \in \strspc$ is a \emph{Dominant Strategy} for $P_i$ if $U_i(\pi_i', \mathbf{\pi}_{-i}) < U_i(\pi_i, \mathbf{\pi}_{-i})$, $\forall \pi_i' (\neq \pi_i )\in \strspc $ and $\forall \mathbf{\pi}_{-i} \in \strspc^{n-1}$. 
	\end{definition}
	Such a strategy $\pi_i$ guarantees that a party $P_i$ can accrue the best utility among all strategies available to it.
	In the above case, $\pi_i'$ is also termed as \emph{Dominated Strategy}. The parties typically avoid dominated strategies, whereas dominant strategies are pursued. We also have a weaker notion of \emph{Dominant Strategy} known as \emph{Weakly Dominant Strategy}.  
	
	\begin{definition} [Weakly Dominant Strategy~\cite{TCC:Katz08b}] \label{def-wdse} 
		Given a normal form game: $\left \{\{\Gamma_i\}_{i=1}^n, \{U_i\}_{i=1}^n\right \}$
		we say $\pi_i \in \strspc$ is a \emph{Weakly Dominant Strategy} for $P_i$  if $U_i(\pi_i', \pi_{-i}) \leq U_i(\pi_i, \pi_{-i}), \forall  \pi_i'(\neq \pi_i) \in \strspc ,  \forall \pi_{-i} \in \strspc^{n-1}$. 
		In addition,  $\forall \pi_i' (\neq \pi_i)$ there exists some $\pi_{-i} \in \strspc^{n-1}$ such that $U_i(\pi_i', \pi_{-i}) < U_i(\pi_i, \pi_{-i})$. 
	\end{definition}
	
	\begin{definition}[Weakly Dominant Strategy Equilibrium (W-DSE)~\cite{narahari14}]\label{def-wdseqbm} 
		For a normal form game $\left \{\{\Gamma_i\}_{i=1}^n, \{U_i\}_{i=1}^n \right \}$, the strategy profile $\mathbf{\pi} = (\pi_1, \ldots, \pi_n) \in \strspc^n$ is a \emph{Weakly Dominant Strategy Equilibrium} if $\forall P_i,  i \in [n]$, $\pi_i$ is a \emph{Weakly Dominant Strategy} for party $P_i$. 
	\end{definition}
	
	A \emph{Dominant Strategy Equilibrium}, whenever it exists, guarantees that every party has a unique \emph{Dominant Strategy} available to it. Thus, each party can realize maximum utility by adopting its \emph{Dominant Strategy}. Since such a strategy becomes a preferred choice for every party, irrespective of the strategic choices of other parties in the game, the chosen strategy profile is an equilibrium.  
	
	\section{Rational Security model} \label{sec-rational-security}
	We model the second price auction to be a game in which participating bidders are rational PPT parties with their individual utility functions. A rational party does not deviate from the protocol arbitrarily, but does so only for its own individual `advantage' -- without any consideration for others. 

 \par We consider a setting in which parties value their individual privacy over learning private inputs of other parties. This means, parties would prefer to learn about private inputs of other parties only if there is no loss of individual privacy in the process. 
 \begin{definition}[Privacy sensitive rational party]
     Let $(P_1, \ldots, P_n)$ be a set of rational PPT parties. A party $P_i$ is said to be \emph{Privacy sensitive rational} if $P_i$ does not prefer to lose its privacy -- even if such a loss would result in gaining information about private inputs of other parties $P_k, k \neq i$.
 \end{definition}
Such \emph{Privacy sensitive rational parties} would not be forming any collusion in order to learn about other parties' inputs. That is because, collusion incurs loss of privacy for each member of the collusion. However, they would be willing to form collusion to make monetary gains.
 
Moreover, for the case of auctions, our utility function will capture the view that the parties are self-interested agents who care most about winning the auction. A \emph{secondary} incentive may be to learn about the private bid values of other parties. To formalize this, we consider monetary utility and information utility~\cite{C:MilNieTri09}. We assume that parties pay a deposit, which they may lose if they are detected to be deviating. The monetary utility is calculated based on this cost and the monetary gain from winning the auction. The information utility captures the fact that parties prefer to reveal as little as possible about their inputs while learning as much as possible about other parties' inputs. 

Since we are considering rational parties, we let the parties choose suitable strategies for enhancing their utilities. The protocol demands that parties choose honest strategy and follow the protocol. However, depending on their utilities, rational parties may choose deviating strategies as well. Moreover, parties can form strategic coalitions for either winning the auction or for learning about private bids of other parties.
	
We are interested in those strategies which are self-enforcing on the parties. Such a state, where parties do not have any incentive to deviate from their chosen set of strategies, is also referred to as an \emph{equilibrium}. 
To demonstrate security in the rational setting, we first show that following the protocol is a weakly dominant strategy equilibrium. Consequently, to show privacy, it suffices to show that when parties do follow the protocol, they learn nothing beyond the output of the protocol. We show this using the existence of a simulator in the ideal world-real world paradigm. 
	
	In a work on first price auctions, Ganesh \etal~\cite{gks22} define the solution concept called \emph{Privacy enhanced computational dominant strategy equilibrium} (PECDSE) for analyzing rational security. In short, parties participating in a game, using a cryptographic protocol, prefer to follow the protocol honestly while learning nothing more about the private inputs of other parties than what the protocol outputs. We will use this notion of equilibrium to show the rational security of our protocol. The definition from ~\cite{gks22} is reproduced below.
	
	\begin{definition} [Privacy Enhanced Computational Dominant Strategy Equilibrium]\cite{gks22} \label{def-priv-enh-dse}
		Let $(P_1, \ldots, P_n)$ be a set of rational PPT parties with their respective efficiently computable utility functions $U_i$, while participating in a $n$-party protocol $\Pi$ which computes the functionality $\calf$. Let $\strspc$ denote the space of strategies. Let $\pi_{i} \in \strspc$ be the strategy for $P_i$ of following $\Pi$. Let $\pi_i'\in \strspc$ be an arbitrary, efficiently computable strategy.
		
		We say that the protocol $\Pi$ is a \emph{Privacy Enhanced Computational Dominant Strategy Equilibrium} if the following hold with probability  $(1-\mathsf{negl}(\lambda))$, where $\lambda$ is the security parameter. 
		
		\begin{enumerate}
			\item  $\Pi$ is a \emph{Weakly Dominant Strategy Equilibrium} (W-DSE); i.e.,
			\[U_i(\pi_i', {\pi}_{-i}) \leq U_i(\pi_i, {\pi}_{-i})\] 
			for all arbitrary efficiently computable ${\pi}_{-i} \in \strspc^{n-1}$.
			\item When every $P_i, i \in [n]$ uses $\pi_{i} \in \strspc$ as the strategy following $\Pi$, for each $P_i$ there exists a simulator $\cals_{i}^\calf$ such that the view of $P_i$ in a real execution of the protocol is computationally indistinguishable from the output of the simulator:
			\[\view_i^\Pi \approx_c \cals_{i}^\calf \]
		\end{enumerate}
		where $\view_i^\Pi$ is the random variable of the transcript of $P_i$ in the protocol $\Pi$. 
	\end{definition}

	
	Thus, in order to show rational security, we show that the following properties hold:
	\begin{enumerate}
		\item \textsc{Equilibrium} (Part (1) of Definition~\ref{def-priv-enh-dse}). We first show that the dominant strategy for parties is to follow the protocol. This property relies on the indistinguishability of bit encoding scheme (DDH), binding property of commitment scheme, malicious security of the OT protocol $\Pi_{OT}$ and soundness of NIZK proofs.
		\item \textsc{Simulation} (Part (2) of Definition~\ref{def-priv-enh-dse}). When parties follow the protocol, we show privacy using the simulation paradigm. Specifically, we show  the existence of a simulator for every party such that the view of the party in the real world is indistinguishable from the output of the simulator. Here we use the hiding property of commitment scheme, semi-honest security of the OT protocol, indistinguishability of bit encoding scheme (DDH) and zero-knowledge property of NIZK proofs. 
	\end{enumerate}

\subsection{Utilities}
  We assume there are $n$ parties that participate in the auction protocol, denoted by $P_1, P_2, \dots, P_n$. Each party $P_i$ has its bid denoted by $b_i$, with a corresponding $l$-bit decomposition  $(b_{i1}||b_{i2}|| \dots || b_{il})$. Let
	\begin{itemize}[itemsep=.5pt]
		\item $v_i$: Perceived private valuation of the auction item for $P_i$. 
		
		\item $b_i$: Bid value of party $P_i$. Each bid value is a $l$ bit integer. Note that, for second price auctions, rational bidders prefer to use $b_i = v_i$~\cite{vk09}. We denote $\textbf{b} = (b_1, \ldots, b_n)$.
		
		\item $w$ denotes the index of the winning party and $s$ denotes the same for the second highest bidder.
		
		\item $U_i: \strspc^n  \mapsto \mathbb{R}$ is the monetary utility function of a party $P_i$ mapping a strategy profile to a value. Here $\strspc$ represents the strategy space.
		
		
		\item $Z_i \in \mathbb{R}$: is the information utility\footnote{The information utility captures subjective valuation of privacy information by a party. Hence, we do not treat it as a function.} of party $P_i$.

		\item $\adv$: Set of parties caught deviating.
	\end{itemize}
	
	A rational party's utility function evaluates the gains or losses incurred by the party because of its strategic choices. 
	In addition to monetary considerations, parties are also curious to learn information about the bid values of other parties provided, their own privacy is not compromised in the process. 
	For this, we consider \emph{information utility} $Z_i$ similar to the notion used in \cite{gks22}. \\
	
	The monetary utility function of an individual party $P_i$ from participating in our protocol $\Pi$ is as follows (where $D$ is the security deposit paid by the bidder for participation in the auction):
	\[U_i = 
	\begin{cases}
		v_i - b_s  &\text{$\argmax(\textbf{b}) = i$ and $P_i$ doesn't deviate} 	\\
		0  &\text{$\argmax(\textbf{b}) \neq i$ and $P_i$ doesn't deviate}\\
		-D  &\text{$P_i$ deviates and gets caught}\\
		\frac{D|\adv|}{(n-|\adv|)}  &\text{$P_i$ doesn't deviate, $\adv$ is set of parties caught}\\
		&\text{ deviating or abort from protocol.}
	\end{cases}\]
	
	In an ideal execution with a trusted party, each party $P_i$ learns the second highest bid value $b_s$ and the identity of the winning party $P_w$. Let this information be valued at $z_i \in \mathbb{R}^+$ by $P_i$. By correctness of our protocol, the information utility realized by $P_i$ by following the protocol honestly is  $z_i$.\\
    Let $A$ be an arbitrary set of parties other than $P_i$ i.e., $A \subseteq [n]\setminus \{i\}$. Let $b_A$ represent the bid values of parties in set $A$. Then $P_i$ would be interested to learn about some function $f(b_A)$. On the other hand, being privacy sensitive, $P_i$ would be wary of some $j\neq i$ such that $P_j$ learns $g(b_i)$ for some function $g$. We capture these considerations as below:
 \begin{equation} \label{eqn-info-util}
	Z_i  \begin{cases}
		= z_i  &\text{if $P_i$ learns no more than output of auction protocol.}\\
		>z_i  &\text{if $P_i$ learns $f(b_A)$ (as described above)}\\
		< 0 &\text{if $\exists j\neq i$ such that $P_j$ learns $g(b_i)$ for some function $g$. }\\
        < z_i  &\text{if protocol aborts.}\\
	\end{cases}
  \end{equation}
	The negative information utility holds even if $P_i$ has additionally learnt about $f(b_k), k\neq i$ for some function $f$. This is to emphasise that a privacy sensitive rational party does not prefer to lose its privacy even if it helps in learning about other parties' bids.\\
	We further consider a dictionary order of utility for each party:
	\begin{equation} \label{util-dict-order}
		(U_i, Z_i)< (U_i', Z_i'), if \left\{\begin{array}{lr}
			(U_i < U_i') \lor \\
			\left(\begin{split}(Z_i < Z_i') \land (U_i = U_i')\end{split}\right)        
		\end{array}\right.
	\end{equation}  
	This order captures the assumption regarding rational parties that they value  monetary utility to be higher than the information utility.

 
	%\input{proto-spec}
	\section{Our protocol}\label{sec-proto-spec-spa}
	We now present a description of our second price auction protocol $\Pi$, which does not require any auctioneer and guarantees full privacy in the presence of privacy sensitive rational parties.
	
	\subsection{Notation}
	We use a fixed publicly known value of the security deposit amount, $D$, for all parties. This value of $D$ can be, for instance, the reserve price of the auctioned item. We use as building blocks a maliciously secure OT protocol $\Pi_{OT}$, a secure commitment scheme $\com$ and non-interactive zero-knowledge (NIZK) proofs. We use a group $\grp$ of prime order $q$ where the DDH assumption holds. 
	

	The protocol uses a Bulletin Board (BB) for all communication. We use the notation $A_{ij,k}$ to denote the message or random value $A$ generated by the party $P_i$ while interacting with the party $P_k$ during the round $j$. The protocol proceeds in $l$ rounds. In each round $j$, a party $P_i$ computes the bit it contributes, denoted by $d_{ij}$, as per Anonymous Bidding Protocol (ABP). We denote the encoding of $d_{ij}$ as $B_{ij}$. ABP and its bit encoding scheme are described in Appendix~\ref{proto-abp}. The protocol also uses a fixed maximum time $\tau$ that a party gets to post its message, beyond which, the party is considered to have aborted the protocol. We use $[0]_{ij}, [1]_{ij}$ to denote encoding of bits $0$ and $1$ respectively by $P_i$ during round $j$. $\smpl$ denotes uniform sampling from a certain distribution, $\pay$ denotes payment and $\bbwrite$ denotes writing to BB.


\subsection{Construction} \label{proto-spec-spa}
We describe our second price auction protocol as a set of algorithms. During setup phase (Algorithm~\ref{alg:setup}), parties allocate their secret keys, construct commitments and publish the public keys and commitments to the BB.
\begin{algorithm}[ht]
\caption{Setup Phase}
\label{alg:setup}
\begin{algorithmic}[1]%\vspace{-0.4cm}
	\State Each $P_i$:
    \State $P_i(v_i, b_i)$ // Initialize
    \State $Deposit \pay D$ // Register for auction
    \State $\mathsf{pp} =  (\grp, q, g, h,l,\tau)$ // Receive public parameters
    \For{$j = 1$ to $l$}                    
        \State $x_{ij}, r_{ij} \smpl \zq$ 
        \State // Secret keys: $x_{ij}$ for encoding $0$ and $r_{ij}$ for encoding $1$
        \State $X_{ij} = g^{x_{ij}}$ // Public key
        \State $a_{ij} \smpl \zq$ // Randomness for commitment
        \State $c_{ij} = \com(b_{ij}, a_{ij})$ 
        \State
        \State $BB \bbwrite (X_{ij}, c_{ij})$
        \State $Y_{ij} = 
        \dfrac{\prod_{k=1}^{i-1} X_{kj}}{\prod_{k=i+1}^n X_{kj} }$
    \EndFor
    \State $state_i \leftarrow active$
\end{algorithmic}
\end{algorithm}

Auction phase (Algorithm~\ref{alg:auction}) runs for $l$ rounds. During each round, parties use ABP to determine their contribution bit for the round and exchange encoded bits through OT. At the end of each round, parties compute the output bit.

\begin{algorithm}[ht]
\caption{Auction Phase}
\label{alg:auction}
\begin{algorithmic}[1]%\vspace{-0.4cm}

    \State Each $P_i$ receiving from $P_k$ through OT during round $j$:
        \If{$state_i = active$} // $P_i$ is still in race
            \State $d_{ij} = b_{ij}$
        \EndIf
        \If{$state_i = winner$} 
            \State $d_{ij} = 1$  
        \EndIf

        \If{$state_i = loser$} 
            \State $d_{ij} = 0$
        \EndIf
        \If{$d_{ij} = 0$}
        	\State $B_{ij} =  Y_{ij}^{x_{ij}}$ // $[0]_{ij}$
        \Else
        	\State $B_{ij} = g^{r_{ij}}$ // $[1]_{ij}$
        \EndIf

        \State {\bf OT Receiver:}$(P_i)$
        \State $\alpha_{ij,k} = d_{ij}$,\;\; $\beta_{ij,k} \smpl \sfr$
        \State $\otr_{ij,k}^1=\mathsf{OT.R}_1(\alpha_{ij,k}, \beta_{ij,k})$, \;\; $BB \bbwrite \otr_{ij,k}^1$
        \State  //Write OT receiver randomness to BB for $P_i \leftarrow P_k$
        \State {\bf OT Sender:} $(P_k)$
        \State  $M_{kj,i}^{(1)} = B_{kj}$
        \State $\omega_{kj,i} \smpl \zq$, \;\; $M_{kj,i}^{(0)} = g^{\omega_{kj,i}}$.  
        \State // $0$-Token of $P_k \rightarrow P_i$
        
        \State $\delta_{kj,i} \smpl \zq$, \;\; $\Omega_{kj,i}=\com(\omega_{kj,i}\delta_{kj,i})$, \;\; $BB \bbwrite \Omega_{kj,i}$ 
        \State // Write commitment to $0$-token to BB
        \State $\ots_{kj, i} = \mathsf{OT.S}\left(\otr_{ij,k}^1, M_{kj,i}^{(0)}, M_{kj,i}^{(1)}, \gamma_{kj,i}\smpl \sfr\right)$
        \State $BB \bbwrite \ots_{kj, i}$ // OT sender randomness of $P_k \rightarrow P_i$
        \State $P_i$ retrieves $P_k$'s message as $B_{kj,i} = \mathsf{OT.R}_2(\ots_{kj, i},\beta_{ij,k})$.
        \State {\bf DO}  $Winner\;Discovery$ (Algorithm~\ref{alg:winner-discovery})
        \State {\bf DO}  $Write\;to\;BB$ (Algorithm~\ref{alg:write-to-BB})
        \State {\bf DO}  $Cheater\;Detection$ (Algorithm~\ref{alg:cheater-detection})
        \State {\bf DO}  $Compute\;Output$ (Algorithm~\ref{alg:compute-output})
        
\end{algorithmic}
\end{algorithm}
\begin{algorithm}[ht]

\caption{$Cheater\;Detection$}
\label{alg:cheater-detection}
\begin{algorithmic}[1]%\vspace{-0.4cm}
        \State Each $P_i$ during round $j$ with $(d_{ij} = 1)$:
        \If{$B_{kj,i} \neq B_{kj}$ }
        	\State $BB \bbwrite (\beta_{ij,k}, a_{ij},x_{ij}, r_{ij})$
        	\State // $P_i$ opens its OT randomness, commitment, and secret key for round $j$
        	\State $P_k$ forfeits deposit to $P_i$ // $P_k$ is cheater
        	\State $state_i = terminate$
        \EndIf
        \State Each $P_i$ during round $j$
        \If{Messages not received from $P_k$ within $\tau$ units}
            \State Declare timeout against $P_k$
           	\State $P_k$ forfeits deposit to honest parties // $P_k$ is cheater

            \State $state_i = terminate$
        \EndIf
        \State
\end{algorithmic}
\end{algorithm}

Each party contributing a $1$ during a round checks locally if it is the winner, as in Algorithm~\ref{alg:winner-discovery}. The winner discovery happens oblivious to other parties. 
\begin{algorithm}[ht]
\caption{$Winner\;Discovery$}
\label{alg:winner-discovery}
\begin{algorithmic}[1]%\vspace{-0.4cm}
	\State Each $P_i$ during round $j$ with $d_{ij} = 1$:
    \State $B = \prod_{k \in [n],k \neq i} B_{kj}\cdot [0]_{ij}$ \label{compute-or-of-others}
    \If{$B = 1$}
        \State $state_i = winner$
    \EndIf
\end{algorithmic}
\end{algorithm}
After a successful winner discovery, winner's behavior is different from other parties as can be seen in Algorithm~\ref{alg:write-to-BB}. \\
\begin{algorithm}[ht]
\caption{$Write\;to\;BB$}
\label{alg:write-to-BB}
\begin{algorithmic}[1]%\vspace{-0.4cm}
    \If{$state = winner$} 
	   \State // Winner $P_w$ with $(state_w = winner)$ during round $j$:
      \State $B = \prod_{k \in [n],k \neq w} B_{kj}\cdot [0]_{wj}$
      \If{$B = 1$}
        \State $BB \bbwrite [0]_{wj}$
      \Else
        \State $BB \bbwrite [1]_{wj}$
      \EndIf
    \Else // Not a winner
      \State $BB \bbwrite B_{ij}$
    \EndIf
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[ht]
\caption{$Compute\;Output$}
\label{alg:compute-output}
\begin{algorithmic}[1]%\vspace{-0.4cm}
        \State Each $P_i$ during round $j$:
        \State \quad $B = \prod_{k \in [n]} B_{kj}$
        \quad \If{$B = 1$}
        \State \quad $b_{sj} = 0$
        \Else
        \State \quad$b_{sj} = 1$
        \EndIf
        \If{$b_{sj} = 1 \land d_{ij} = 0$}
        \State  $state_i = loser$
        \EndIf
        \State After $l$ rounds, $b_s = (b_{s1}|| \cdots || b_{sl})$
\end{algorithmic}
\end{algorithm}
After $l$ rounds of auction phase, verification phase (Algorithm~\ref{alg:verification}) is initiated to check if the parties had been honest in their computation. If any cheating is detected or if there is any timeout noticed, the protocol terminates. The aborted and cheating parties lose their deposits which is redistributed among the honest parties. Honest parties get back their deposits.\\

\paragraph{Remark 1:} 
    Our protocol assumes a unique highest bidder. If there are multiple highest bidders then the computed output also happens to be the highest bid value. In such a case, we can use arbitrary tie breaking mechanisms to choose the winner. \girisha{What about winning bid? Can we make it as $1$ less than the computed value? Just to make it rational for chosen winner?} \\ 
\paragraph{Remark 2:} We would like to emphasise that the Winner resolution procedure in Algorithm~\ref{alg:verification} acts as a deterrent for any rational party from cheating.  A rational party does not use this mechanism to learn about the bid value of another. This follows from our assumption that each party values its monetary utility to be higher than the information utility. 
\begin{algorithm}[ht]
	\caption{Verification phase}
	\label{alg:verification}
	\begin{algorithmic}[1]%\vspace{-0.4cm}
		\State {\bf Winner Claim:}\label{winner-proof}
		\State For $P_w$ claiming auction, for all $j \in [l]$:
		\State \quad $BB \bbwrite (x_{wj}, r_{wj})$ \quad// Private keys used for computation
		\State
		\State {\bf Winner resolution:}\label{prf-resolve-winner} 
		\State Each $P_i$ claiming auction, for all $j \in [l]$ and $k \in [n], k \neq i$:
		\State \quad $BB \bbwrite (\beta_{ij,k}, \gamma_{ij,k})$
		\State \quad $BB \bbwrite (c_{ij}, a_{ij})$
		\State Public verification of consistency of claimant's messages
		\State
		\State {\bf Proof of correct choice bit:}			\label{prf-loser-choice-bit}

		\State Each $P_i, i \neq w$, for all $j \in [l]$ with $b_{sj} = 0$ and $k \in [n], k \neq i$:
		\State \quad$BB \bbwrite M_{kj,i}^{(0)}$ // $0$-token received from $P_k$
		\State \quad$BB \bbwrite (\omega_{ij,k}, \delta_{ij,k})$ // Commitments to $0$-tokens sent to $P_k$
		\State
		\State {\bf Proof of correct computation:}\label{proto-nizk}
		\State Each $P_i, i \neq w$, for all $j \in [l]$ with $b_{sj} = 1$:
		\State \quad $BB \bbwrite$ NIZK proof for relation in equation~\ref{rel-not-win} of Appendix ~\ref{app-nizk}.
		\State
		\State Honest parties get back their deposit.
		\State Parties failing to provide $0$-token or accepting NIZK are considered cheating and forfeit deposit, which is distributed among the honest parties.
	\end{algorithmic}
\end{algorithm}


	We show that the above protocol correctly computes the second highest bid in Appendix~\ref{proto-correctness}. In the next section, We analyze the strategies of a party participating in the protocol. We show  that the honest strategy is weakly dominant for any party $P_k$. We then prove that this protocol does not leak anything, other than the protocol output, to any party that does not deviate from the protocol in Appendix~\ref{app:privacy}. Transactions related to security deposit are handled outside the protocol (see Appendix~\ref{app-contract}).
	
	%\input{cb.tex}
	\section{Analysis of strategies of rational parties in the protocol} \label{sec-rational-strtg}
	
	At any point during the protocol, a party's action (contribution to protocol) is decided by the strategy and the partial transcript available (view). In our protocol, after the setup phase, the parties go through in $l$-rounds, where each round comprises of three parts, exchanging bit codes through OT, local computation to update state, and writing to BB. Correspondingly, in each round of protocol, every party $P_i$ with strategy $\pi_i$ contributes three types of input, namely, $\cb_{ij,k}, \bcot_{ij,k}\text{ and }\bcbb_{ij}$. Here $\cb_{ij},k$ denotes the choice bit used by the $P_i$ as an OT receiver with $P_k$ in round $j$ of protocol;  $\bcot_{ij},k$ denotes the encoding of $d_{ij}$ that $P_i$ uses as OT sender in round $j$ with $P_k$, and $\bcbb_{ij}$ is the encoding of $d_{ij}$ that $P_i$ writes on BB in round $j$. There is a unique honest strategy for each party. We describe all other strategies of a party as deviations from the honest strategy. One particular deviating strategy for party $P_i$ is to form collusion with any other party $P_k$. 
	
	We will denote the action selected by  $P_i$ in round $j$ using honest strategy $\pi_i$  while interacting with $P_k$ as $s_{ij,k}$ and action selected using deviating strategy as $s_{ij,k}'$. We also denote the winner discovery round by $\bar{j}$. 
	%An action set $S_i$ for a party $P_i$ is the tuple of actions chosen during the protocol execution $S_i = (s_{ij,k}), j \in [l], k \in [n]\setminus \{i\}$. 
	The Table~\ref{tab-strategies} summarizes the honest and deviant actions which are described subsequently. For example, suppose $P_i$ is interacting with $P_k$ during round $j$. Then an action $t_{a\rightarrow b} \in \{\cb_{ij,k}, \bcot_{ij,k}, \bcbb_{ij}\}, a,b \in \{0.1\}$ means $P_i$ is supposed to use the bit $a$ in honest run of protocol, but chooses the bit $b$. 
	In each case, we show that, the parties realize the best utility by following the protocol honestly.
	
	\begin{table}[H]
		\footnotesize
		\begin{minipage}{0.45\textwidth} 	
			\begin{tabular}{|p{3.1cm}|p{2cm}|p{2cm}|}
				\hline
				&  {\bf Actions using honest strategy}&{\bf Actions using dishonest strategy}\\	
				\hline
				{\bf Choice bit selection} & $\cb_\oo,\cb_\zz$ &$\cb_\oz,\cb_\zo$\\
				\hline
				{\bf Bit code sent to other parties using OT} & $\bcot_\oo,\bcot_\zz$ &$\bcot_\oz,\bcot_\zo$ \\
				\hline
				{\bf Bit codes written to BB} &$\bcbb_\oo, \bcbb_\zz$    &$\bcbb_\oz,\bcbb_\zo$\\
				\hline
			\end{tabular}
			\caption{Actions available for parties. }
			\label{tab-strategies}
		\end{minipage}
		
	\end{table}
	
	\paragraph{Remark 1:} We consider only those actions of parties that affect the outcome of the protocol. However, there are other actions available to the party: sampling non-uniform randomness, opening invalid $0$-tokens and aborting. However, each of these is an outright irrational choice. For instance, sampling non-uniform randomness (e.g. for private keys) would potentially leak the bid value of the deviating party. Similarly, opening  invalid $0$-tokens is easily caught because of commitments to $0$-tokens (step \ref{prf-loser-choice-bit} of verification phase). Lastly, abort results in loss of security deposit. Such irrational actions are not considered for the ensuing discussion on rational security.
	
	\paragraph{Remark 2:} Only the highest bidder can come forward to claim the auction by paying the computed output. This is because, for any other bidder participating in a second price auction, it is not rational to pay the second highest bid value. \\
	
	
	\noindent We first prove a result that would be useful for subsequent proofs.
	\begin{lemma}\label{lem-diff-bitcode}
		Let $P_k$ be an arbitrary party who uses actions $\bcot_{a \rightarrow b}$ and $\bcbb_{a \rightarrow d}$ such that $b \neq d$ during some round $j$. Let $P_i$ be the honest party who uses $d_{ij} = 1$. 
		Assuming that $\Pi_{OT}$ is a maliciously secure OT protocol, $P_i$ will successfully identify $P_k$'s cheating with overwhelming probability. 
	\end{lemma}
	
	\begin{proof}
		Consider a cheating party $P_k$ who uses actions $\bcot_{a \rightarrow b}$ and $\bcbb_{a \rightarrow d}$ such that $b \neq d$ during some round $j$. Then the party $P_i$ with $d_{ij} = 1$ can show that $P_k$ has indeed sent some bit code during OT and written another bit code to BB as described in step~\ref{alg:cheater-detection} cheater detection part of the protocol specification. 
		
		Firstly we claim that no cheating party $P_i$ can implicate an honest party $P_k$. Suppose, on the contrary, that $P_i$ claims $P_k$ is cheating. 
		In response, honest $P_k$ successfully opens its OT sender randomness $\gamma_{kj,i}$ such that $\ots_{kj, i} = \mathsf{OT.S}\left(\otr_{ij,k}^1, M_{kj,i}^{(0)}, B_{kj}, \gamma_{kj,i}\right)$. 
		Now $P_i$ has to produce a valid bit code $B_{kj}'$ to have been received from $P_k$ through OT, such that, 
		\begin{align*}
			&B_{kj}'= \mathsf{OT.R}_2(\ots_{kj, i},\beta_{ij,k}')\\
			&\implies \ots_{kj, i} = \mathsf{OT.S}\left(\otr_{ij,k}^1, M_{kj,i}^{(0)}, B_{kj}', \gamma_{kj,i}\right)
		\end{align*}
		However, this would contradict the correctness of $\Pi_{OT}$.
		
		Likewise, cheating $P_k$ can not refute honest $P_i$'s claim by producing different sender randomness to show that the two bit codes are the same. Again, suppose on the contrary that $P_k$ is able to produce two different OT sender randomness $\gamma_{kj,i}, \gamma_{kj,i}' \in \sfr$ such that
		\begin{align*}
			\ots_{kj, i} &= \mathsf{OT.S}\left(\otr_{ij,k}^1, M_{kj,i}^{(0)}, B_{kj}, \gamma_{kj,i}\right)\\
			&= \mathsf{OT.S}\left(\otr_{ij,k}^1, M_{kj,i}^{(0)}, B_{kj}', \gamma_{kj,i}'\right)
		\end{align*}
		This means OT sender $P_k$ is able to produce two different OT sender randomness, both of which generate the same OT sender message $\ots_{kj, i}$ for two different messages $B_{kj}, B_{kj}'$ -- contradicting the correctness of $\Pi_{OT}$. 
	\end{proof}
	
	\subsection{Choice bit selection} If $state=active$, each party $P_i$ uses bit $d_{ij}$ derived from ABP as its choice bit during round $j$. If $state=winner$, the party chooses $1$ as the choice bit and if $state=loser$, the party chooses $0$ as the choice bit. Let us denote a party's action by $\cb_{a \rightarrow b}$.  A deviating party can choose the choice bit for learning  bit codes from other parties. Thus each party has the following actions available: $\{\cb_\zz, \cb_\oo, \cb_\oz, \cb_\zo\}$ during a particular round for choice bit selection.
	
	\begin{lemma} \label{lem-cb-info-utility}
		For any rational PPT party $P_i$, let  
		$\pi_i$ be the honest strategy, and $\pi_i'$ be the strategy in which $P_i$ deviates using either $\cb_\oz$ or $\cb_\zo$ in some arbitrary round $j$. Then, assuming that DDH assumption holds in $\grp$, $\com$ is a secure commitment scheme and $\Pi_{OT}$ is maliciously secure OT, the strategy $\pi_i$ weakly dominates the strategy $\pi_i'$  for all $i \in [n]$ during all rounds $1 \leq j \leq l$ as per the \emph{Weakly dominant strategy equilibrium} Definition~\ref{def-wdse}. 
	\end{lemma}
	
	\begin{proof}
		We first note that any strategy followed by $P_i$ for choice bit selection only affects the view of $P_i$, and the view of all other parties remains unaffected. Suppose $P_i$ uses a cheating strategy while interacting with another party $P_k$. I.e., $s_{ij,k}\in\{\cb_\oz, \cb_\zo\}$,  for arbitrary $i$, $j$ and $k$ with $i\neq k$. The following cases can occur:
		\begin{itemize}
			\item $\cb_\oz$:  Suppose $j< \bar{j}$, where $\bar{j}$ is the ``winning round". Then, $P_i$ will not be able to perform winner discovery (step ~\ref{compute-or-of-others} in the winner discovery sub-phase) as it has not received the correct bit codes. In this case, the following can occur:
			\begin{itemize}
				\item If $P_i$ does not cheat in $\bcot_{ij,k}$ and $\bcbb_{ij}$, then there is no change in view of other parties, and this does not affect the protocol. In this case, there is no change in gain in the utility of $P_i$.
				\item If $P_i$ cheats in $\bcot_{ij,k}$ and/or $\bcbb_{ij}$, then we will show in the next lemmas that there is a loss in the utility of $P_i$.
			\end{itemize}
			On the other hand, if $j\geq \bar{j}$, $P_i$ will not be able to execute its honest strategy in round $j$ for BB phase ($P_i$ can not do step ~\ref{compute-or-of-others} in winner discovery sub-phase as $P_i$ does not receive the contribution of $P_k$). Therefore, with non-zero probability, $P_i$ cheats in $\bcot_{ij,k}$ and/or $\bcbb_{ij}$.
			In both the above cases, $P_i$'s utility is no better than staying honest, i.e., $\forall i \in [n], k \neq i$:
			\begin{align*}	
				U_i(\pi_i', \hat{\pi}_{-i})_{s_{ij,k}' = \cb_\oz} \leq U_i(\pi_i, \hat{\pi}_{-i})_{s_{ij,k} = \cb_\oo}
			\end{align*}
			\item $\cb_\zo$: In this case, observe that $P_i$ will be caught if $P_i$ does not claim the auction, as $P_i$ will not be able to provide $0$-token for round $j$, if $b_{sj} = 0$ (Verification phase step~\ref{prf-loser-choice-bit} in the protocol). On the other hand, if $b_{sj} = 1$, it doesn't learn any extra information than while being honest. Thus, $\forall i \in [n], k \neq i$:
			\begin{align*}	
				U_i(\pi_i', \hat{\pi}_{-i})_{s_{ij,k}' = \cb_\zo} \leq U_i(\pi_i, \hat{\pi}_{-i})_{s_{ij,k} = \cb_\zz}
			\end{align*}
			So, let us consider the case when $P_i$ claims the auction. Following are the two cases that can occur:
			\begin{itemize}
				\item $P_i$ is the actual winner: In this case $d_{kj}=0,\forall k\neq i$. Since $P_i$ would have anyway learned the encoding of other parties' bits from the BB round, $P_i$ does not gain any information  utility in this case.
				\item $P_i$ is not the actual winner: In this case, there is a player $P_w$ with a bid higher than $P_i$ and $w\neq i$. The following cases can occur:
				\begin{itemize}
					\item Protocol output (price of the auction) $<b_w$: In this case, if $P_w$ will also claim the auction if it is honest. $P_i$'s cheating will be caught at step ~\ref{prf-resolve-winner} in verification phase. Hence the monetary utility of $P_i$ reduces in this case.
					\item Protocol output (price of the auction) $\geq b_w$: In this case, $P_i$ has to pay more than $b_i$ and hence its monetary utility decreases.
				\end{itemize}
			\end{itemize}
			From the above cases, we have $\forall i \in [n], k \neq i$:
			\begin{align*}	
				U_i(\pi_i', \hat{\pi}_{-i})_{s_{ij,k}' = \cb_\zo} \leq U_i(\pi_i, \hat{\pi}_{-i})_{s_{ij,k} = \cb_\zz}			
			\end{align*}       
			To argue that honestly following the protocol is a weakly dominant strategy, consider the strategy set $\hat{\pi}_{-i}$ wherein at least one other party $P_k$ deviates using the action $\cb_\zo$ during every round, i.e., $s_{kj,i}' = \cb_\zo, \forall j \in [l], i \neq k$. In this case, if $P_i$ chooses to be honest, $P_i$ is guaranteed to get the security deposit redistribution of a cheater. On the other hand, $P_i$'s deviation would result in either losing the auction or getting caught to lose the security deposit. Thus in this case, \[U_i(\pi_i', \hat{\pi}_{-i}) < U_i(\pi_i, \hat{\pi}_{-i}), \forall i \in [n]\]        
			Thus $P_i$'s weakly dominant strategy is to stay honest and use actions $s_{ij,k} \in \{\cb_\zz, \cb_\oo\}$, $\forall k \in [n]$ for all rounds $j \in [l]$, irrespective of the strategies $\hat{\pi}_{-i}$ of other parties. Thus we have,      
			\[U_i(\pi_i', \hat{\pi}_{-i}) \leq U_i(\pi_i, \hat{\pi}_{-i}), \forall i \in [n]\]  
		\end{itemize}
	\end{proof}
	
	%\input{bcot.tex}
	\subsection{Bit codes sent to other parties using OT}
	Each party shares its bit codes through OT to all other parties during each round. Only parties using a $1$ as the choice bit can retrieve these bit codes for their local computation. We denote this action by $\bcot_{a \rightarrow b}$. A deviating party can choose to send bit codes so as to learn the highest bid value. Thus each party has the following actions available to it: 
	$\{\bcot_\zz, \bcot_\oo, \bcot_\oz, \bcot_\zo\}$ during each round.
	
	\begin{lemma} \label{lem-bcot-mon-utility}
		For any rational PPT party $P_i$, let  
		$\pi_i$ be the honest strategy, and $\pi_i'$ be the strategy in which $P_i$ deviates using either $\bcot_\oz$ or $\bcot_\zo$ in some round. Then, assuming that DDH assumption holds in $\grp$, $\com$ is a secure commitment scheme, $\Pi_{OT}$ is a maliciously secure OT, NIZK proofs are sound, the strategy $\pi_i$ weakly dominates the strategy $\pi_i'$  for all $i \in [n]$ during all rounds as per the \emph{Weakly dominant strategy equilibrium} Definition~\ref{def-wdse}.
	\end{lemma}
	
	\begin{proof}
		Consider an arbitrary round $j$. Party $P_i$ does not have any information about $d_{kj}$ for any $k\neq i$ before the OT round. Therefore, the choice of $\bcot_{ij,k}$ is independent of $d_{kj}$. Now, the following cases can arise:
		\begin{itemize}
			\item $d_{kj}=0$: In this case, if $P_k$ is honest in $\cb_{kj,i}$ selection, then choice of $\bcot_{ij,k}$ makes no difference in the protocol. Hence, deviating $P_i$ does not gain any utility in this case. On the other hand, if $P_k$ cheats, $P_k$ will not be able to produce $0$-token for the round and will get caught (step ~\ref{prf-loser-choice-bit} in the protocol). In such a case, $P_i$ would get the redistribution of the security deposit if it does not get caught and loses the security deposit if gets caught. In either case, $P_i$'s utility does not increase by cheating.
			\item $d_{kj}=1$: In this case, if $P_k$ chooses to cheat in $\cb_{kj,i}$ selection, then $P_i$'s utility remains at most as much as its utility without cheating; but in case $P_k$ is honest in the selection of $\cb_{kj,i}$, then by Lemma ~\ref{lem-diff-bitcode}, $P_k$ can catch the cheating behavior of $P_i$ if $P_i$ does not cheat in $\bcbb_{ij}$. If $P_i$ cheats in $\bcbb_{ij}$, then $P_i$ would fail to provide accepting NIZK. Either way $\forall i \in [n], k \neq i$ and $a \neq b$,
		\end{itemize}
		\begin{align*}	
			U_i(\pi_i', \hat{\pi}_{-i})_{(s_{ij,k} =  \bcot_{a\rightarrow b})} \leq
			U_i(\pi_i, \hat{\pi}_{-i})_{(s_{ij,k} =  \bcot_{a\rightarrow a})}
		\end{align*}
		Lastly, consider the strategy set $\hat{\pi}_{-i}$ wherein at least one other party $P_k$ uses the action $\bcot_\zo$ during every round, i.e., $s_{kj,i}' = \bcot_\zo, \forall j \in [l], i \neq k$. In this case, if $P_i$ chooses to be honest, $P_i$ is guaranteed to get the security deposit redistribution of a cheater. On the other hand, $P_i$'s deviation would result in either losing the auction or getting caught to lose the security deposit. Thus in this case, \[U_i(\pi_i', \hat{\pi}_{-i}) < U_i(\pi_i, \hat{\pi}_{-i}), \forall i \in [n]\]
		Thus $P_i$'s weakly dominant strategy is to stay honest and choose $s_{ij,k} \in \{\bcot_\zz, \bcot_\oo\}$ for all rounds $j \in [l]$ while interacting with all parties $k \in [n], k \neq i$, irrespective of the strategies $\hat{\pi}_{-i}$ of other parties. Hence we have,
		\[U_i(\pi_i', \hat{\pi}_{-i}) \leq U_i(\pi_i, \hat{\pi}_{-i}), \forall i \in [n]\] 
		
	\end{proof}
	
	%\input{bcbb.tex}
	\subsection{Bit codes written to BB} Towards the end of each round, every party writes the bit codes used for computation during that round onto BB. This is to facilitate the computation of the auction-price bit for the round. The actions chosen by a party for this step are denoted by $\bcbb_{a \rightarrow b}$ where $a,b \in \{0,1\}$. Since each party evaluates the computed bit using bit codes on BB to decide whether it stays in the race or not, these actions are decisive. Thus each party has the following actions available to it: $\{\bcbb_\zz, \bcbb_\oo, \bcbb_\oz, \bcbb_\zo\}$ during each round.
	We would like to emphasize that no bidder can use the action $\bcbb_\zo$ to become a winner. This is because, writing to the BB does not affect winning chances, but only affects the price to be paid for the auction. Moreover, deviating actions $\bcbb_\zo, \bcbb_\oz$ do not help to fetch any extra information than while being honest.
	
	\begin{lemma} \label{lem-bcbb-mon-utility}
		For any rational PPT party $P_i$, let  
		$\pi_i$ be the honest strategy, and $\pi_i'$ be the strategy in which $P_i$ deviates using either $\bcbb_\oz$ or $\bcbb_\zo$ in some round. Then, assuming that DDH assumption holds in $\grp$, $\com$ is a secure commitment scheme and NIZK proofs are sound, the strategy $\pi_i$ weakly dominates the strategy $\pi_i'$  for all $i \in [n]$ during all rounds as per the \emph{Weakly dominant strategy equilibrium} Definition~\ref{def-wdse}.
	\end{lemma}
	\begin{proof}
		Note that any party $P_i$ that cheats in $\bcbb_{ij}$ and does not claim the auction  gets caught because they cannot provide an accepting NIZK (in step ~\ref{proto-nizk} of the verification phase of protocol). 
		\[U_i(\pi_i', \hat{\pi}_{-i}) \leq U_i(\pi_i, \hat{\pi}_{-i}), \forall i \in [n]\]   
		So the only case to be considered is if $P_i$ cheats in $\bcbb_{ij}$ and claims the auction. The following cases can occur:
		\begin{itemize}
			\item $\bcbb_\zo$: In this case, the computed value (the auction price) is more than $P_i$'s bid. Hence $P_i$ will lose monetary utility $\forall i \in [n], k \neq i$:
			\[U_i(\pi_i', \hat{\pi}_{-i})_{(s_{ij,k} =  \bcbb_\zo)} < 
			U_i(\pi_i, \hat{\pi}_{-i})_{(s_{ij,k} =  \bcbb_\zz)} \]
			\item $\bcbb_\oz$: 
			Firstly, observe that this case can occur only when $j \neq \bar{j}$. However, in this case, there exists at least another party $P_k$ with $d_{kj} =1$. If $P_k$ is honest, the computed output will be $1$ and hence $P_i$ would not be able to provide winning proof as described in step~\ref{winner-proof} of the verification phase and loses deposit. If $P_k$ is dishonest, $P_i$'s utility would be no better than staying honest. Hence $\forall i \in [n], k \neq i$:
			\[U_i(\pi_i', \hat{\pi}_{-i})_{(s_{ij,k} =  \bcbb_\oz)} \leq 
			U_i(\pi_i, \hat{\pi}_{-i})_{(s_{ij,k} =  \bcbb_\oo)} \]
		\end{itemize}
		Thus $P_i$'s weakly dominant strategy is to honestly choose $s_{ij,k} \in $ $\{\bcbb_\zz, \bcbb_\oo\}$, $\forall k \in [n]$ for all rounds $j \in [l]$, irrespective of the strategies $\hat{\pi}_{-i}$ of other parties.
		Thus for all $i \in [n]$ we have:
		\[U_i(\pi_i', \hat{\pi}_{-i}) \leq U_i(\pi_i, \hat{\pi}_{-i})\]
	\end{proof}

 \subsection{Colluding parties}
 Each party $P_i$ can strategically form collusion with other parties. The intent of collusion can be either to win the auction or gain information related to bids of other parties. We denote the collusion strategy by $\coll$ where $\calc$ is the set of colluding parties. The utilities of the collusion can be written as follows:
 \begin{itemize}
     \item {\bf Monetary utility} of the collusion is the sum of individual monetary utilities of its members. I.e., $U_\calc = \sum_{i \in \calc} U_i$.

     \item {\bf Information utility} of the collusion $Z_\calc$ is a function of individual information utilities of parties $(P_{i_1}, \dots, P_{i_m})$ in collusion. $Z_\calc = f(Z_{i_1}, \dots, Z_{i_m})$ where the function $f$ satisfies the property that $f(Z_{i_1}, \dots, Z_{i_m}) > f(Z_{i_1}', \dots, Z_{i_m}')$ if and only if $\exists i_k \in \{i_1,\dots, i_m\}$ such that $Z_{i_k} > Z_{i_k}'$. E.g. $P_{i_k}$ has learnt some information about the bids of parties who are not part of collusion $\calc$.
 \end{itemize}
 We now show that when parties collude together, they can not gain while participating in the protocol.
\begin{lemma} \label{lem-collusion}
		For any privacy sensitive rational PPT party $P_i$, let  
		$\pi_i$ be the honest strategy, and $\pi_i'$ be the strategy in which $P_i$ deviates using either $\coll$ in some round. Then, assuming that DDH assumption holds in $\grp$, $\com$ is a secure commitment scheme and NIZK proofs are sound, the strategy $\pi_i$ weakly dominates the strategy $\pi_i'$  for all $i \in [n]$ during all rounds as per the  Definition~\ref{def-wdse}.
	\end{lemma}
 \girisha{Need to move  this proof to Appendix to save space}
\begin{proof}
    Let $\calc = \{P_{i_1}, \dots, P_{i_m}\}$ be a collusion. We will argue that $\calc$ can not make gains either in monetary or information utility. 
    \begin{enumerate}
        \item {\bf Monetary utility}: Suppose that collusion $\calc$ decides to deviate in some round $j$. This means, at least one of the parties in $\calc$ has to deviate while using the actions: $\cb, \bcot, \bcbb$. However, as proved in the Lemmas~\ref{lem-cb-info-utility}, \ref{lem-bcot-mon-utility}, \ref{lem-bcbb-mon-utility} such a deviation is detected and party loses its security deposit. Such deviations are dominated by honest execution of protocol actions. The same holds for every party in the collusion $\calc$. Hence the collusion $\calc$ can not take any deviating action which benefits the collusion. Thus collusion as a strategy for any party for the sake of monetary gains is dominated by acting individually.

        \item {\bf Information utility}: Now let us consider the case when parties do not deviate, but utilize pool of their views of protocol to lean about bids of parties not part of collusion. We will consider two sub cases here.
        \begin{itemize}
            \item {Second highest bidder is not in $\calc$}: In this case, even if all remaining parties collude together, the best they can learn from the protocol is the bits of second highest bid -- which is the output of protocol. \\
            However, from Equation~\ref{eqn-info-util}, we have that each $P_{i} \in \calc$ would end up with negative information utility since other parties in $\calc$ can learn about $P_{i}$'s private inputs. Since we are considering privacy sensitive parties, the collusion can not be formed in the first place.
            \item {Second highest bidder is in $\calc$}: In this case, parties in $\calc$ can learn about the first few bits (leakage bits) of highest bid among the parties not part of collusion $\calc$. However, in the process, privacy of parties in $\calc$ is lost. In particular, second highest bidder's identity gets compromised. This holds even if the parties in $\calc$ were to run a MPC to compute the leakage bits. Assuming that second highest bidder is privacy sensitive, it can not be part of $\calc$. Since, no party would know up front if it is second highest bidder or not, it would continue to stay away from being in collusion.
        \end{itemize}
 
    \end{enumerate}
    
     Thus, collusion as a strategy, is dominated by acting individually.
    
 \end{proof}

    
	We are now ready to prove the main result for rational security which follows from the above Lemmas~\ref{lem-cb-info-utility}, \ref{lem-bcot-mon-utility},  \ref{lem-bcbb-mon-utility} and \ref{lem-collusion}.
	\begin{theorem}\label{thm-dom-str}
		Let  $P_i, i \in [n]$ be any PPT party participating in the second price auction protocol $\Pi$ described in Section~\ref{proto-spec-spa}. Then, assuming that the DDH assumption holds in $\grp$, $\com$ is a secure commitment scheme and $\Pi_{OT}$ is a malicious secure OT implementation, the protocol $\Pi$ is a weakly dominant strategy equilibrium as per Definition ~\ref{def-wdse}. 
	\end{theorem}

	%\input{pedse.tex}
	\subsection{Privacy enhanced rational security protocol} \label{privacy-spa-rational}
	Having established the equilibrium from Theorem~\ref{thm-dom-str}, to argue privacy, it suffices to show that nothing beyond the output is learned by parties who are non-deviating. 	For this, we use the \textit{ideal world -- real world paradigm}. First we present the description of a simulator. We would like to emphasize that due to the symmetric nature of our protocol, it suffices to show the simulator for one party which would be same for others too. We then show that the view of a party $P_k$ in a real run of the protocol is indistinguishable from the output of the simulator. We denote by $\view_k^{\Pi}$, the distribution of the view of party $P_k$ while participating in protocol $\Pi$.
	
	
	\begin{theorem}
		\label{thm-privacy-sim-rational}
		Assuming $\com$ is a secure commitment scheme, DDH assumption holds in the group $\grp$, $\Pi_{OT}$ is a semi-honest secure OT protocol and zero knowledge property holds for the NIZKs, $\Pi$ specified in Section~\ref{proto-spec-spa} securely realizes the functionality $\calf$ in the presence of non-deviating parties. 
	\end{theorem}
	We present the ideal functionality $\mathcal{F}$ and the proof in Appendix~\ref{app:privacy}.
	
	The following Theorem stating that $\Pi$ is a \emph{Privacy Enhanced Computational Dominant Strategy Equilibrium}, follows as a corollary of Theorems~\ref{thm-dom-str} and~\ref{thm-privacy-sim-rational}.
	
	\begin{theorem} \label{thm-priv-dom-str}
		Let $P_i, i \in [n]$ be rational parties with respective utility functions $(u_1, \ldots, u_n)$ as described above. Assuming $\com$ is a secure commitment scheme, DDH in group $\grp$ and $\Pi_{OT}$ is a maliciously secure OT protocol and zero knowledge property holds for the NIZKs, the protocol $\Pi$ described in Section~\ref{proto-spec-spa} is a privacy enhanced computational dominant strategy equilibrium as per Definition ~\ref{def-priv-enh-dse}.
	\end{theorem}
	
	%\input{expt.tex}
	\section{Experimental results}\label{sec-expt}
	Our protocol was implemented in C++ and executed on a single machine using Intel core i7 processor with 32GB RAM, 2.9 GHz, running Ubuntu 22.04 operating system. Each bidder is represented by a separate process. We have used the elliptic curve secp256k1 as the underlying Group from OpenSSL. NUMS implementation is used for computing the group generators. We have implemented the NIZKs required for our protocol (for relation~\ref{rel-not-win} in Appendix~\ref{app-nizk}) using the construction from \cite{cs97,fast21}. We instantiate our Oblivious Transfer with the construction in Figure $13$ of \cite{AC:CanSarWan20}. In the following, we compare our protocol's run time and communication cost with the protocols from MP-SPDZ suite ~\cite{keller20} in Table~\ref{tab-eff-comp-protocol}. For each protocol, the measurements are taken for $15$ bidders with bid value $100 \leq b < 1000$. We observe that our protocol runs 1.7X faster than the semi-honest protocol $Atlas$.
	\begin{table}[H]
		\footnotesize
		\begin{minipage}{0.45\textwidth} 
			\centering	
			\begin{tabular}{|p{1.5cm}|p{1.25cm}|p{1.1cm}|p{2.15cm}|}
				\hline
				\textbf{Protocol}  &{\bf Threat \newline model} &{\bf Run time \newline (in sec)} &{\bf Communication Complexity (in MB)}\\	
				\hline
				Our SPA Protocol &Rational &1.26  &0.779 \\
				\hline
				Atlas~\cite{C:GLOPS21} &Semi-honest  &2.11 &6.09  \\
				\hline
				Mascot~\cite{CCS:KelOrsSch16} & Malicious   &55.65 &4074.5  \\
				\hline
				Semi-BMR~\cite{bmr19} & Semi-honest   &198.77 &18462  \\
				\hline
				Real-BMR~\cite{bmr19} & Malicious   &1137.39 &109905 \\
				\hline
			\end{tabular}
			\caption{Comparison of the efficiency of protocols. }
			\label{tab-eff-comp-protocol}
		\end{minipage}
		
	\end{table}
	\begin{figure}[h]
		\includegraphics[scale=0.4]{../chart-1.png}
	\end{figure}
	\begin{figure}[h]
		\includegraphics[scale=0.4]{../chart-2.png}
		\caption{Protocol Run times vs number of bidders}
		\label{fig-perf-plot}
	\end{figure}
	
	Figure~\ref{fig-perf-plot} shows the plot of run times of various protocols for different numbers of bidders. For BMR protocols, the maximum number of bidders we could consider while running on our machine was $15$, and for Mascot, it was $35$. 
	\section{Conclusion}
	We construct a protocol for \emph{Second Price Auction} that is provably secure in the rational setting and concretely efficient. We utilize the notion of \textit{Privacy Enhanced Computational Dominant Strategy Equilibrium} to establish rational security. Our work leaves open several interesting questions about extending the protocol to other flavors of auctions, such as multi-unit auctions, analyzing other adversarial models like adaptive strategies.
	\girisha{Can we remove the conclusion. It doesn't seem to be adding much of value.}
	%\section{Appendices}

%If your work needs an appendix, add it before the
%``\verb|\end{document}|'' command at the conclusion of your source
%document.

%Start the appendix with the ``\verb|appendix|'' %command:
%\begin{verbatim}
%  \appendix
%\end{verbatim}
%and note that in the appendix, sections are lettered, not numbered. This document has two appendices, demonstrating the section and subsection identification method.


%%
%% The acknowledgments section is defined using the "acks" environment
%% (and NOT an unnumbered section). This ensures the proper
%% identification of the section in the article metadata, and the
%% consistent spelling of the heading.
%\begin{acks}
%To Robert, for the bagels and explaining CMYK and color spaces.
%\end{acks}

%%
%% The next two lines define the bibliography style to be used, and
%% the bibliography file.
\clearpage
\bibliographystyle{ACM-Reference-Format}
\bibliography{../cryptobib/abbrev3,../cryptobib/crypto,ref}


%%
%% If your work has an appendix, this is the place to put it.
\appendix

%\input{correct.tex}
\section{Correctness of protocol $\Pi$} \label{proto-correctness}
In this section, we will show that the protocol specified in Section~\ref{proto-spec-spa} correctly computes the second highest bid value and identifies the highest bidder.
\begin{lemma}\label{lem-OR}
	In round $j$ of SPA, for $j\in [l]$, the computed bit $b_{sj}$ is the OR of contributed bits from all parties i.e.,  $b_{sj} = \lor_{i=1}^n d_{ij}$, for $i\in [n]$. Consequently, the computed bit is $\max_i(d_{ij})$, for $j\in [l]$.
\end{lemma}
\begin{proof}
	This follows directly from the property of encoding scheme (as described in Appendix~\ref{proto-abp}). If at least one of the parties $P_i$ has contributed $1$-bit code $B_{ij}$, the product $\prod_{i=1}^n B_{ij} \neq 1$ and thus computed output $b_{sj} = 1$. On the other hand, if $B_{ij}$ is $0$-bit code for all $i \in [n]$ then $\prod_{i=1}^n B_{ij} = 1$ and thus computed output $b_{sj} = 0$. Since the OR function outputs maximum of the input bits, computed bit is $\max_i(d_{ij})$, for $j\in [l]$.
\end{proof}
\begin{lemma}\label{lem-unique-winner}
	In the protocol specified in Section~\ref{proto-spec-spa}, there is exactly one party (denoted by $P_w$) that enters post winning phase, when all the parties follow the protocol honestly and have distinct bid values. 
\end{lemma}
\begin{proof}
	Suppose there is no $j\in[l]$ such that $j$ is the winning round for any party. Then, we have that for every $j$, it is not the case that exactly one party contributes 1-bit. Also, note that an honest party contributes $1$-bit only if they have not yet lost the auction. Now, Let us denote by $S_k$, the set of all parties who have not yet lost in the auction till round $k$. Then we have $|S_k|\geq |S_{k+1}|$, $\forall k\in[l-1]$. And we have, since no party has reached the post winning phase, $S_l\geq 2$. But this implies that all the parties in $S_l$ have the same bid, which is contrary to our assumption that no parties have same bids.\\
	Now suppose more than two parties reach the post winning phase. Then one of the following cases occur:
	\begin{itemize}
		\item Both parties reach post winning phase in same round: In the protocol, a party reaches the post winning phase only if it is the only party that contributes $1$-bit in the OT phase of that round. Hence, two parties cannot reach post winning phase in the same round.
		\item One party reaches post winning phase before other party: If one party reaches post winning phase, then it always contributes $1$ in the OT phase in all the subsequent rounds. Hence, after a party has reached the post winning phase, no other party can be the only party contributing $1$ in any subsequent rounds.
	\end{itemize}
\end{proof}
\begin{theorem} \label{thm-honest-bidder-correct} 
	The protocol specified in Section~\ref{proto-spec-spa} computes the second highest bid value correctly when all parties follow the protocol.
\end{theorem}
\begin{proof}
	From Lemma~\ref{lem-OR}, we have that the computed output during each round is the highest of bit contributed from the bidders. Moreover, recall that unique winner in the protocol writes the same bit codes to BB as that of second highest bidder. This prevents second highest bidder from assuming that it is the winner and also ensures that second highest bidder does not drop out of race all through the protocol. Thus, during every round the computed bit corresponds to that of second highest bid.
\end{proof}


\begin{theorem}
	The protocol specified in Section~\ref{proto-spec-spa} correctly identifies the highest bidder when all parties follow the protocol.
\end{theorem}

\begin{proof}
	From Lemma~\ref{lem-unique-winner} we have a unique winner in the protocol. During the winner discovery round, winner alone has a $1$ bit to contribute while every other party has a $0$ bit to contribute. Thus, winner's bid value is higher than all other bidders.
\end{proof}

%\input{app.tex}
\section{Proof of Theorem~\ref{thm-privacy-sim-rational}}
\label{app:privacy}
\paragraph{Ideal Functionality.}
We consider the ideal functionality $\calf$ to identify the winner and to compute second highest bid. The functionality $\calf$ operates with a set of parties $P = \{P_1,\ldots, P_n\}$ as follows:
\begin{itemize}
	\item Each party $P_i$ invokes $\calf$ with input $b_i$.
	\item Once all $n$ bids are available, $\calf$ computes:\\
	$w = \argmax_i(b_i)$ and $b_s = \max_{i \neq w}(b_i)$
	\item $\calf$ returns the tuple ($w, b_s$) to each party.
\end{itemize}  

\begin{theorem}[Theorem 5.6 restated]
	Assuming $\com$ is a secure commitment scheme, DDH assumption holds in group $\grp$, $\Pi_{OT}$ is a semi-honest secure OT protocol and zero knowledge property holds for the NIZKs, $\Pi$ specified in Section~\ref{proto-spec-spa} securely realizes the functionality $\calf$ in the presence of non-deviating parties.
\end{theorem}
\begin{proof}
	We will construct a simulator $\cals$ for a PPT semi-honest party $P_k$, such that 
	\[\view_k^{\Pi} \approx_c \cals^\calf_{P_k} \] 
	
	The simulator is invoked with public parameters $\mathsf{pp}$, and bid value $b_k$ of $P_k$. 
	
	\paragraph {Setup Phase}: 
	\begin{itemize}
		\item $\cals$ samples secret keys and randomness $x_{ij}, r_{ij} \smpl \zq$ on behalf of all parties $P_i, i \in [n]$. It samples OT sender randomness $\gamma_{ij,m} \in \sfr$ and OT receiver randomness $\beta_{ij,m} \in \sfr$ for all $P_i$ interacting with $P_m$ during round $j \in [l]$. Computes the public keys $X_{ij} = g^{x_{ij}}, \forall i \in [n]$.  
		
		\item $\cals$ generates the $0$-tokens $\omega_{ij,m}$ for each party $P_i$ interacting with party $P_m$, for rounds $1 \leq j \leq l$.
		
		\item $\cals$ generates the corresponding commitments to $0$-tokens:
		chooses $\delta_{ij,m} \smpl \zq, j \in [l]$, computes $\Omega_{ij,m} = g^{\omega_{ij,m}}h^{\delta_{ij,m}}$. 				
		
		\item For each party $P_i, i \neq k, i \neq s, i \neq w$: $\cals$ constructs commitments to bits of bid values of $0$:
		chooses $a_{ij} \smpl \zq, j \in [l]$, computes $c_{ij} = g^{0}h^{a_{ij}}$.
		
		\item $\cals$ invokes $\calf$ on behalf of $P_k$ with input $b_k$ to obtain $(w, b_s)$.
		
		\item  If $b_k \neq b_s$, one of the parties is designated as $P_s$. For this party, $\cals$ constructs commitments $c_{sj} = \com(b_{sj},a_{sj})$. Else commitments are constructed for bits of $b_k$.
		
		If $k \neq w$, $\cals$ chooses $\bar{j}$ to be the smallest value of $j$ such that $b_{sj} = 0, 1 \leq j \leq l$. $\cals$ chooses $b_w$ such that its first $\bar{j}-1$ bits are equal to corresponding bits of $b_s$, $b_{w\bar{j}}=1$ and remaining bits are all $0$.  $\cals$ computes bit commitments for party $P_w$ for bits $b_{wj}$ and party $P_k$ for bits $b_{kj}, j \in [l]$. \\ 	
		If $k = w$, $\cals$ computes bit commitments for party $P_k$ for bits  $b_{kj}, j \in [l]$. \\
		All commitments are written to BB.
	\end{itemize}
	\paragraph {Auction phase:} For this phase, we need to distinguish three cases.
	\begin{enumerate}
		\item $P_k$ is the winner :
		\begin{itemize}
			\item In this case, $b_w = b_k$. $\cals$ identifies the round $\bar{j}$  in which $b_w$ differs from $b_s$. 
			\item For $1 \leq j < \bar{j}$ and each $i \neq k$, $\cals$ invokes $\mathsf{OT.R}_1(b_{kj}, \beta_{kj,i})$ to obtain $\otr^{1}_{kj,i}$. For $\bar{j} \leq j \leq l$,  $\cals$ invokes $\mathsf{OT.R}_1(1, \beta_{kj,i})$ to obtain $\otr^{1}_{kj,i}$.
			
			\item For the party $P_s$, $1 \leq j \leq l$ and $i \neq s$, $\cals$  invokes $\mathsf{OT.R}_1(b_{sj}, \beta_{sj,i})$ to obtain $\otr^{1}_{sj,i}$.
			
			\item For all other parties $P_m$, for $1 \leq j \leq l$ and $i \neq m$, $\cals$ invokes $\mathsf{OT.R}_1(0, \beta_{mj,i})$ to obtain $\otr^{1}_{mj,i}$.\\
			All $\otr^{1}$ messages are written to BB.
			
			\item For the winner, $\cals$ generates $B_{wj}$ for the bits corresponding to $b_s$ for all rounds $1 \leq j \leq l$. $\cals$ generates bit codes $B_{sj}$ for the bits corresponding to $b_s$ for all rounds $1 \leq j \leq l$. For the remaining bidders, $\cals$ generates $0$-bit codes for all rounds. All bit codes are written to BB at the end of each round.
			
			
			\item For $P_w$, $\cals$  computes\\ $\mathsf{OT.S} (\otr^{1}_{ij,w}, g^{\omega_{wj,i}}, B_{wj}, \gamma_{wj,i})$ to obtain $\ots_{wj,i}$ for all parties $i \neq w$ and for $1 \leq j < \bar{j}$. For rounds $\bar{j} \leq j \leq l$, $\cals$ samples $M_{wj}' \smpl \grp$ and runs $\mathsf{OT.S} (\otr^{1}_{ij,w}, g^{\omega_{wj,i}},$ $M_{wj}', \gamma_{wj,i})$ to obtain $\ots_{wj,i}$ for all parties $i \neq w$.
			
			\item For $P_s$, using $\gamma_{sj,i}$, $\cals$  invokes $\mathsf{OT.S} (\otr^{1}_{ij,s}, g^{\omega_{sj,i}}, B_{sj}, \gamma_{sj,i})$ to obtain $\ots_{sj, i}$ for each OT receiver $P_i$.
			
			\item For $P_m$ where $m \neq w, m \neq s$, using $\gamma_{mj,i}$, $\cals$  runs $\mathsf{OT.S} (\otr^{1}_{ij,m},$ $g^{\omega_{mj,i}}, B_{mj}, \gamma_{mj,i})$ to obtain $\ots_{mj, i}$ for each OT receiver $P_{i}$.\\
			All $\ots$ messages are written to BB.
		\end{itemize}
		\item $P_k$ is the second highest bidder:
		\begin{itemize}
			\item In this case the input $b_k = b_s$. $\cals$ chooses $\bar{j}$ to be the smallest value of $j$ such that $b_{sj} = 0$.
			
			\item For $1 \leq j < \bar{j}$ and $i \neq w$, $\cals$ invokes $\mathsf{OT.R}_1(b_{sj}, \beta_{wj,i})$ to obtain $\otr^{1}_{wj,i}$ for OT sender $P_i$.
			For $\bar{j} \leq j \leq l$ and $i \neq w$, $\cals$ invokes $\mathsf{OT.R}_1(1, \beta_{wj,i})$ to obtain $\otr^{1}_{wj,i}$.
			
			\item For the party $P_k$, $1 \leq j \leq l$ and $i \neq s$, $\cals$  invokes $\mathsf{OT.R}_1(b_{sj}, \beta_{sj,i})$ to obtain $\otr^{1}_{sj,i}$.
			
			\item For all other parties $P_m$ $m \neq w, m \neq s$, for $1 \leq j \leq l$, $\cals$ invokes $\mathsf{OT.R}_1(0, \beta_{mj,i})$ to obtain $\otr^{1}_{mj,i}$. \\
			All $\otr^1$ messages are written to BB.
			
			\item For the winner $P_w$, $\cals$ generates $B_{wj}$ for the bits corresponding to $b_{sj}$ for all rounds. $\cals$ generates bit codes $B_{sj}$ for the bits corresponding to $b_s$ for all rounds. For the remaining bidders, $\cals$ generates $0$-bit codes for all rounds. All bit codes are written to BB at the end of each round. 
			
			\item For $P_w$, $\cals$  computes\\ $\mathsf{OT.S} (\otr^{1}_{ij,w}, g^{\omega_{wj,i}}, B_{wj}, \gamma_{wj,i})$ to obtain $\ots_{wj,i}$ for all parties $i \neq w$ and for $1 \leq j < \bar{j}$. For rounds $\bar{j} \leq j \leq l$, $\cals$ samples $M_{wj}' \smpl \grp$ and runs $\mathsf{OT.S} (\otr^{1}_{ij,w}, g^{\omega_{wj,i}},$ $M_{wj}', \gamma_{wj,i})$ to obtain $\ots_{wj,i}$ for all parties $i \neq w$.
			
			\item For $P_s$, $\cals$  invokes $\mathsf{OT.S} (\otr^{1}_{ij,s}, g^{\omega_{sj,i}}, B_{sj}, \gamma_{sj,i})$ to obtain $\ots_{sj, i}$ for each OT receiver $P_i, i \neq s$.
			
			\item For $P_m$ where $m \neq w, m \neq s$, $\cals$  runs $\mathsf{OT.S} (\otr^{1}_{ij,m}, g^{\omega_{mj,i}},$ $B_{mj}, \gamma_{mj,i})$ to obtain $\ots_{mj, i}$ for each OT receiver $P_{i}, i \neq m$.\\
			All $\ots$ messages are written to BB.
		\end{itemize}
		\item $P_k$ is neither winner nor second highest bidder.
		\begin{itemize}
			\item In this case $b_k \neq b_s, b_k \neq b_w$. $\cals$ chooses $\bar{j}$ to be the smallest value of $j$ such that $b_{sj} = 0, 1 \leq j \leq l$.
			
			\item $\cals$ compares the value $b_k$ with $b_s$ and identifies the round when $P_k$ would drop out of race and computes the values of $d_{kj}$ for $1 \leq j \leq l$.
			
			\item For $1 \leq j < \bar{j}$ and $i \neq w$, $\cals$ invokes $\mathsf{OT.R}_1(b_{sj}, \beta_{wj,i})$ to obtain $\otr^{1}_{wj,i}$. For $\bar{j} \leq j \leq l$ and $i \neq w$,  $\cals$ invokes $\mathsf{OT.R}_1(1, \beta_{wj,i})$ to obtain $\otr^{1}_{wj,i}$.
			
			\item For the party $P_s$, $1 \leq j \leq l$ and $i \neq s$, $\cals$ invokes $\mathsf{OT.R}_1(b_{sj}, \beta_{sj,i})$ to obtain $\otr^{1}_{sj,i}$.
			
			\item For the party $P_k$, $1 \leq j \leq l$ and $i \neq k$, $\cals$ invokes $\mathsf{OT.R}_1(d_{kj}, \beta_{kj,i})$ to obtain $\otr^{1}_{kj,i}$.
			
			\item For all other parties $P_m$ $m \neq w, m \neq s, m \neq k$, for $1 \leq j \leq l$ and for all other $P_i$, $\cals$ invokes $\mathsf{OT.R}_1(0, \beta_{mj,i})$ to obtain $\otr^{1}_{mj,i}$.\\
			All $\otr^1$ messages are written to BB. 
			
			\item For the winner $P_w$, $\cals$ generates $B_{wj}$ for the bits corresponding to $b_s$ for all rounds $1 \leq j \leq l$. $\cals$ generates bit codes $B_{sj}$ for the bits corresponding to $b_s$ for all rounds $1 \leq j \leq l$. Then $\cals$ generates bit codes $B_{kj}$ for the bits corresponding to $d_{kj}$ for all rounds $1 \leq j \leq l$. For the remaining bidders, $\cals$ generates $0$-bit codes for all rounds. All bit codes are written to BB at the end of each round.
			
			\item For $P_w$, using $\gamma_{wj,i}$ $\cals$  computes\\ $\mathsf{OT.S} (\otr^{1}_{ij,w}, g^{\omega_{wj,i}}, B_{wj}, \gamma_{wj,i})$ to obtain $\ots_{wj,i}$ for all parties $i \neq w$ and for $1 \leq j < \bar{j}$. For rounds $\bar{j} \leq j \leq l$, $\cals$ samples $M_{wj}' \smpl \grp$ and runs $\mathsf{OT.S} (\otr^{1}_{ij,w}, g^{\omega_{wj,i}},$ $M_{wj}', \gamma_{wj,i})$ to obtain $\ots_{wj,i}$ for all parties $i \neq w$.
			
			\item For $P_s$ using $\gamma_{sj,i}$, $\cals$  computes\\ $\mathsf{OT.S} (\otr^{1}_{ij,s}, g^{\omega_{sj,i}}, B_{sj}, \gamma_{sj,i})$ to obtain $\ots_{sj, i}$ for each OT receiver $P_i$. 
			
			\item For $P_k$ using $\gamma_{kj,i}$, $\cals$  computes\\ $\mathsf{OT.S} (\otr^{1}_{ij,k}, g^{\omega_{kj,i}}, B_{kj}, \gamma_{kj,i})$ to obtain $\ots_{kj, i}$ for each OT receiver $P_i$.
			
			\item For $P_m$ where $m \neq w, m \neq s, m \neq k$ using $\gamma_{mj,i}$, $\cals$  runs $\mathsf{OT.S} (\otr^{1}_{ij,m}, g^{\omega_{mj,i}}, B_{ij}, \gamma_{mj,i})$ to obtain $\ots_{mj, i}$ for each OT receiver $P_{i}$.\\
			All $\ots$ messages are written to BB.
		\end{itemize}
	\end{enumerate}
	For each of the above cases, during  {\bf Verification Phase}, $\cals$ does the following:
	\begin{itemize}
		\item $\cals$ generates NIZK proofs for all losing parties for the decider rounds as per their bid values and writes to BB.
		
		\item $\cals$ opens the private keys $x_{wj}, r_{wj}$ used for encoding the bit codes of winner $P_w$ for all rounds, $1 \leq j \leq l$ and writes them to BB.
		
		\item $\cals$ provides the $0$-tokens on behalf of all losing parties for the rounds when computed output is $0$, and writes them to BB. Corresponding $0$-token commitments for each party are also opened onto BB.
	\end{itemize}
	
	In order to argue indistinguishability, we consider following hybrids.  
	
	
	\begin{itemize}
		\item $H_0$: This is the real run of the protocol where parties generate actual public keys, bit commitments to the bits of their bid values, bit codes corresponding to their bid values, $0$-tokens and their commitments, NIZK proofs and generate OT messages as per their contributed bits for the round.
		
		\item $H_1$: This is same as $H_0$ except for following. In the verification phase, NIZK proofs are replaced with simulated proofs by invoking the Zero Knowledge simulator that is guaranteed by the NIZK construction. \\
		By the zero knowledge property of NIZK proofs, $H_1$ is indistinguishable from $H_0$ for all PPT distinguishers.
		
		\item $H_2$: This is same as $H_1$ except for following. During auction phase,  $\beta_{ij,m} \in \sfr$ are sampled for each party $P_i$ acting as OT receiver while interacting with OT sender $P_m$ where $i \neq k, i \neq s, i \neq w$.  $\mathsf{OT.R}_1(0, \beta_{ij,m})$ is used to compute $\otr^{1}_{ij,m}$ and written to BB. \\
		By receiver security of $\Pi_{OT}$, $H_2$ is indistinguishable from $H_1$ for all PPT distinguishers.
		
		\item $H_3$: This is same as $H_2$ except for following. During auction phase, for each OT sender $P_i$ interacting with OT receiver $P_m$, $\mathsf{OT.S} (\otr^{1}_{mj,i}, g^{\omega_{ij,m}}, B_{ij}, \gamma_{ij,m})$ is invoked with $B_{ij}$ being $0$-bit code, to compute $\ots_{ij,m}$ for all parties $i \neq k, i \neq s, i \neq w$ and for $1 \leq j < l$ and written to BB. Moreover, at the end of the round same $0$-bit codes $B_{ij}$ are written to the BB.\\
		By security of the bit encoding scheme, $H_3$ is indistinguishable from $H_2$ for all PPT distinguishers. 
		
		
		\item $H_4$: This is same as $H_3$ except for following. During setup phase, commitments are for $0$-bits for all parties $P_i, i \neq k, i \neq s, i \neq w$ and written to BB. \\
		By hiding property of the commitment scheme $\com$, $H_4$ is indistinguishable from $H_3$ for all PPT distinguishers.
		
	\end{itemize}
	Observe that the hybrid $H_4$ does not have any information about the bid values of parties other than $P_k$ and $P_s$. Thus $P_k$ cannot learn anything about losing bid values in $H_4$. Also, in $H_0$, view of $P_k$ corresponds to the real run whereas $H_4$ corresponds to $\cals$'s output. Moreover, by transitivity, $H_0 \approx_c H_4$. Thus it follows that,  
	\[\view_k^{\Pi} \approx_c \cals_{P_k}^\calf \]
\end{proof}

\section{Collusion resistance} Parties collude in a protocol to achieve certain objective -- typically to enhance their utility or for gaining some information about the other parties' inputs. We define a notion of collusion where parties do not like to collude if it affects their privacy.

\begin{definition} [Special collusion resistance]
    A protocol $\Pi$ among rational PPT parties $P_1, \ldots, P_n$ is said to be \emph{Special collusion resistant} if for all $i$ it holds that $P_i$ does not form collusion with any other $P_j, j \neq i$, if the collusion incurs loss of privacy for $P_i$.
\end{definition}

\begin{lemma}
    Assuming $\com$ is a secure commitment scheme, DDH assumption holds in group $\grp$, $\Pi_{OT}$ is a semi-honest secure OT protocol and zero knowledge property holds for the NIZKs, $\Pi$ specified in Section~\ref{proto-spec-spa} is special collusion resistant.
\end{lemma}

\begin{proof}
    We would like to make following observation. While several possible collusions can be formed, the collusion that is most effective involves first two highest bidders. With any other collusion, the auction outcome would be same as the one without collusion. We will consider following cases:
    \begin{enumerate}
        \item \emph{Ex-ante collusion} The collusion is formed, \emph{before} the protocol begins. In this case, motivation for the collusion is to enhance the utility of the winner by reducing the payment to auctioneer. Hence there is no incentive for second highest bidder to participate in the auction -- since that would reduce the utility for winner. Thus the protocol starts with no collusion.

        \item \emph{Ex-interim/Ex-post collusion} In this case, the collusion is either during or after the protocol execution. In both cases, the motive for the first two bidders is no longer about enhancing the utility, but for learning other parties' bids. This can be accomplished by pooling in the the encoded bits from other parties, share the encoding of $0$-bit with each other and run private computation. This computation reveals the position at which the third highest bidder would have dropped out -- thus revealing first few bits of third highest bidder. \\
        However, notice that such a computation requires the two highest bidders to share their $0$-bit encoding for each round. Thus, privacy is lost. Since we have assumed that rational parties do not like to lose their privacy -- even to gain information on other parties' bids, such a collusion does not manifest.
    \end{enumerate}
\end{proof}

\section{Contract Functionality}\label{app-contract}
Our protocol uses security deposits from the bidders to ensure honest behavior. Any deviation from a bidder that affects the protocol described in Section~\ref{proto-spec-spa} results in the forfeiture of the security deposit which is redistributed among the honest parties. A contract can be used for managing these transactions involving security deposits. Such a functionality can be realized as a contract within a legal framework using fiat currency or if the protocol uses block-chain as the bulletin board (BB), then smart contract with native currency of block-chain can be used.

\section{Anonymous Bidding Protocol} \label{proto-abp}
We use the \emph{Anonymous Bidding Protocol} (ABP) to compute the highest bid value which is a variation of the Anonymous Veto Protocol (AVP) first described in~\cite{avp06} and later used in~\cite{seal19,fast21,gks22}. 

ABP runs for $l$ rounds -- where $l$ is the number of bits in the binary representation of the bid values. The protocol proceeds as below:
\begin{itemize}
	\item Let $P_i$'s bid $b_i = (b_{i1} || \ldots ||b_{il})$.
	\item $P_i$ participates in $j$th round of ABP by contributing $b_{ij}$. This continues until $P_i$ keeps contributing a bit equal to the computed output for the round. If in a round, there is other bidder who contributes a $1$ while the $P_i$ has $0$, $P_i$ drops out of the race at the end of that round.
	
	\item A party who has dropped out of the race, continues to participate in the protocol but only contributes a $0$ for all remaining rounds.
	
	\item Any round $1 \leq j \leq l$ which has at least one bidder bidding a $1$ bit is considered as the \textit{decider round}. 
	
	\item Thus, a bidder $P_i$ uses the bid $d_{ij}$ during round $j$ as
	\[d_{ij} = \begin{cases}
		0, &\text{if $P_i$ is not in race} \\
		&\text{ or $P_i$ bid 0 in any of previous decider rounds. }\\
		b_{ij}, &\text{if $P_i$ is in the race}\\
		&\text{ or $P_i$ bid 1 in all previous decider rounds.}
	\end{cases}\]
	
	\item Logical OR of all individual bids used in $j$th round is evaluated to be the $j$th computed bit. i.e.,
	\[b_{sj} = \bigvee_{i=1}^n d_{ij}\]
	
	\item Protocol's output bid $b_s$ is computed as $b_s = b_{s1} || \cdots || b_{sl}$
\end{itemize}

In order to ensure the privacy of the bits used during computation, the contribution bits are encoded such that no PPT party can distinguish between the encoding of $0$ and encoding of $1$. There can be several possible encodings for representing the bits. For example, parties can use secret share of $0$ to represent $0$-bit encoding and secret share of any non-zero number to represent $1$-bit encoding. The reconstructed value would represent the encoding of computed bit. Notice that this scheme does indeed satisfy the requirements of ABP computation described above.\\ 

However, we use the encoding scheme adopted from \cite{fast21}. For this, we make use of a group $\grp$ of prime order $q$ where DDH assumption holds. Let $g \in \grp$ be a publicly known generator. The encoding and corresponding computation on the coded bits are performed as follows:

\begin{enumerate}
	
	\item Each bidder $P_i$, $i \in [n]$ allocates private keys $x_{ij}, r_{ij} \smpl \mathbb{Z}_q$, $i \in [n], j \in [l]$. Public keys $X_{ij}  = g^{x_{ij}}$ are published to the bulletin board.
	
	\item Once public keys from all bidders are available, each bidder computes:
	$$Y_{ij} = 
	\dfrac{\prod_{k=1}^{i-1} X_{kj}}{\prod_{k=i+1}^n X_{kj} } $$
	
	
	\item Each \emph{contributed} bit  $d_{ij}$  is encoded as : \\
	$B_{ij} =  
	\begin{cases}
		\text{0-bit code}:\quad Y_{ij}^{x_{ij}} 	&\text{if}\quad d_{ij} = 0\\
		\text{1-bit code}:\quad g^{r_{ij}}	&\text{if}\quad d_{ij} = 1
	\end{cases}$
	
	
	\item The $j$th computed bit is evaluated as the logical-OR of individual bidding bits $b_{ij}$ for the $j$th position: $b_{sj} = \bigvee_{i=1}^n b_{ij}$. This is computed  using the encoded bits as follows:\\
	$b_{sj} =\begin{cases}
		0, \quad \text{if} \quad \prod_{i=1}^n B_{ij} = 1\\
		1, \quad \text{if} \quad \prod_{i=1}^n B_{ij} \neq 1
	\end{cases}$
\end{enumerate}
It follows from the DDH assumption holding in the group $\grp$ that the distributions of $0$-bit code and $1$-bit code are computationally indistinguishable.\\



\section{NIZK Proofs}\label{app-nizk}
This section describes the NIZK proof for losing parties. This proof is used to prove that a party has correctly computed the bit code written on to BB during every decider round $j$. For the construction of these NIZKs, we assume that \emph{Pedersen Commitment scheme}~\cite{C:Pedersen91} is used in the protocol. Each losing bidder $P_i$ needs to prove the following for $j$th iteration:

\begin{itemize}
	\item Proof of commitment: $c_{ij} = \com(b_{ij}, a_{ij}) = g^{b_{ij}}h^{a_{ij}}$
	\item Proof of knowledge of secret keys used for computation: $B_{ij} = Y_{ij}^{x_{ij}}$ for the $0$-bit code and $B_{ij} = g^{r_{ij}}$ for the $1$-bit code.
	\item Proof of knowledge of secret key used for computation during the previous decider round $\bar{j}$, $B_{i\bar{j}} = Y_{i\bar{j}}^{x_{i\bar{j}}}$  for the $0$-bit code or $B_{i\bar{j}} = g^{r_{i\bar{j}}}$ for the $1$-bit code. Along with this, knowledge of actual secret keys used for computation during iterations $\bar{j},j$  also need to be proved.
\end{itemize}

Thus, the relation that is established by this NIZK is:

\begin{equation}\label{rel-not-win}
	\calr =  \left\{ 
	\begin{split}
		b_{ij}, a_{ij}, \\ 
		x_{ij}, r_{i\bar{j}},\\
		r_{ij}, x_{i\bar{j}}
	\end{split} \; \Bigg\vert \;
	\begin{split}
		\left.\left(\frac{c_{ij}}{g} = h^{a_{ij}} \land B_{i\bar{j}} = g^{r_{i\bar{j}}} \land B_{ij} = g^{r_{ij}}\right)\right.\bigvee\\
		\left.\left(c_{ij} = h^{a_{ij}} \land B_{ij} = Y_{ij}^{x_{ij}} \land X_{ij} = g^{x_{ij}}\right) \right. \bigvee \\
		\left(
		\begin{split}
			\frac{c_{ij}}{g} = h^{a_{ij}} \land B_{i\bar{j}} = Y_{i\bar{j}}^{x_{i\bar{j}}} \land X_{i\bar{j}} = g^{x_{i\bar{j}}}  
			\land\\ 
			B_{ij} = Y_{ij}^{x_{ij}} \land X_{ij} = g^{x_{ij}}
		\end{split}		\right)  
	\end{split}
	\right\}	
\end{equation}

We use the approach in~\cite{cs97,fast21} for constructing NIZK for the above relation. 
This is accomplished by representing the relation in terms of the following clauses:
\[\begin{split}
	F_1 = &DL(h, c_{ij}) \otimes \left[DL(Y_{ij}, B_{ij}) \cap DL(g,X_{ij})\right]\\
	F_2 = &DL(h, c_{ij}/g) \otimes DL(g, B_{i\bar{j}}) \otimes DL(g, B_{ij})\\
	F_3 = &DL(h, c_{ij}/g) \otimes \left[ DL(Y_{i\bar{j}}) \cap DL(g, X_{i\bar{j}})\right] \otimes \\
	&\left[DL(Y_{ij}, B_{ij}) \cap DL(g,X_{ij})\right]
\end{split}\]
Thus, the proofs need to be constructed for $F = F_1 \cup F_2 \cup F_3$.\\

To prove the knowledge of either $F_1$ or $F_2$ or $F_3$, assuming that $F_k$ is known, party $P_i$ proceeds as follows:
\begin{enumerate}
	\item Choose $v_0, v_1, v_2, v_3, v_4, v_5, v_6, v_7 \smpl \mathbb{Z}_q$.
	\item Choose $(w_0, w_1, w_2)$ with $w_k = 0$ and $w_i \smpl \mathbb{Z}_q$ for $i \neq k$.
	\item Compute the commitment tokens: 
	\begin{itemize}
		\item $t_0 = c_{ij}^{w_0}h^{v_0}$, \quad
		$t_1 = B_{ij}^{w_0}Y_{ij}^{v_1}$, \quad
		$t_2 = X_{ij}^{w_0}g^{v_1}$
		\item $t_3 = \left(\dfrac{c_{ij}}{g}\right)^{w_1}h^{v_2}$, \quad
		$t_4 = B_{i\bar{j}}^{w_1}g^{v_3}$, \quad
		$t_5 = B_{ij}^{w_1}g^{v_4}$, 
		\item $t_6 = \left(\dfrac{c_{ij}}{g}\right)^{w_2}h^{v_5}$, \quad
		$t_7 = B_{i\bar{j}}^{w_2}Y_{i\bar{j}}^{v_6}$,
		\item $t_8 = X_{i\bar{j}}^{w_2}g^{v_6}$, \quad
		$t_{9} = B_{ij}^{w_2}Y_{ij}^{v_7}$, \quad
		$t_{10} = X_{ij}^{w_2}g^{v_7}$
	\end{itemize}
	
	\item Compute the random challenge using the public hash function as: $$H = \calh\left(\substack{h, c_{ij}, Y_{ij}, B_{ij},g, X_{ij}, \dfrac{c_{ij}}{g}, B_{i\bar{j}}, Y_{i\bar{j}}, X_{i\bar{j}},\\ t_0, t_1, t_2, t_3, t_4, t_5, t_6, t_7, t_8, t_9, t_{10}} \right) \mod q$$
	
	\item Compute $(\gamma_0, \gamma_1, \gamma_2)$ as:
	\[\gamma_i = 
	\begin{cases}
		H - (w_0 + w_1 + w_2) \mod q, \quad &\text{if $i = k$}	\\
		w_i, \quad &\text{otherwise}
	\end{cases}\]
	
	\item Set:\\
	$(u_0, u_1, u_2, u_3, u_4, u_5, u_6, u_7) = 
	\begin{cases}
		(a_{ij}, x_{ij}, 0,0,0,0,0,0), \; k = 1	\\
		(0,0, a_{ij}, r_{i\bar{j}}, r_{ij},0,0,0), \; k = 2 \\
		(0,0,0,0,0, a_{ij}, x_{i\bar{j}}, x_{ij}), \; k = 3 
	\end{cases}$
	
	\item Compute responses $R = (s_0, s_1, s_2, s_3, s_4, s_5, s_6, s_7, s_8, s_9, s_{10})$ as (all operations are modulo $q$):
	\begin{itemize}
		\item $s_0 = v_0 - \gamma_k u_0$
		\item $s_1 = s_2 = v_1 - \gamma_k u_1$
		\item $s_3 = v_2 - \gamma_k u_2$
		\item $s_4 = v_3 - \gamma_k u_3$
		\item $s_5 = v_4 - \gamma_k u_4$
		\item $s_6 = v_5 - \gamma_k u_5$
		\item $s_7 = s_8 = v_6 - \gamma_k u_6$		
		\item $s_{9} = s_{10} = v_7 - \gamma_k u_7$
		
	\end{itemize}
	
	\item Publish the proof as:\\ $\pi = (\gamma_0, \gamma_1, \gamma_2, s_0, s_1, s_2, s_3, s_4, s_5, s_6, s_7, s_8, s_9, s_{10})$. 
	
	\item Proof validity can be checked by reconstructing the commitments:
	\begin{itemize}
		\item $t_0' = c_{ij}^{\gamma_0} h^{s_0}$,\quad \quad \quad
		$t_1' = B_{ij}^{\gamma_0} Y_{ij}^{s_1}$, \quad
		$t_2' = X_{ij}^{\gamma_0} g^{s_2}$
		\item $t_3' = (c_{ij}/g)^{\gamma_1} h^{s_3}$, \quad 
		$t_4' = B_{i\bar{j}}^{\gamma_1}g^{s_4}$, \quad
		$t_5' = B_{ij}^{\gamma_1} g^{s_5}$
		\item $t_6' = (c_{ij}/g)^{\gamma_2} h^{s_6}$, \quad
		$t_7' = B_{i\bar{j}}^{\gamma_2}Y_{i\bar{j}}^{s_7}$
		\item $t_8' = X_{i\bar{j}}^{\gamma_2} g^{s_8}$, \quad \quad
		$t_{9}' = B_{ij}^{\gamma_2} Y_{ij}^{s_{9}}$, \quad
		$t_{10}' = X_{ij}^{\gamma_2} g^{s_{10}}$	
	\end{itemize}
	\item Evaluate:
	\begin{align*}
		H' = \calh\left(\substack{
			h, c_{ij}, Y_{ij}, B_{ij},g, X_{ij}, \dfrac{c_{ij}}{g}, 
			B_{i\bar{j}}, Y_{i\bar{j}}, X_{i\bar{j}}, \\
			t_0', t_1', t_2', t_3', t_4', t_5', t_6', t_7', t_8', t_9', t_{10}'}
		\right)\mod q
	\end{align*}
	\item Then check for following condition:
	\[\gamma_0 + \gamma_1 + \gamma_2 \overset{?}{=} H'\]
	\item Accept if the check passes.
\end{enumerate}
\section{Secure computation of stateful functions} 
The secure computation is challenging in itself. It gets more involved when we consider sateful functions. 
\end{document}
\endinput
%%
%% End of file `sample-sigconf.tex'.
